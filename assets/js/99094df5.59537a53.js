"use strict";(self.webpackChunkarchetype_docs=self.webpackChunkarchetype_docs||[]).push([[8917],{4048:function(e,t,a){var n=a(5318);t.Z=void 0;var r=n(a(4938)),o=a(5893),s=(0,r.default)((0,o.jsx)("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"}),"OpenInNew");t.Z=s},1519:function(e,t,a){a.d(t,{Z:function(){return y}});var n=a(3366),r=a(7462),o=a(7294),s=a(6010),i=a(7192),l=a(1796),p=a(2110),d=a(1539),c=a(8979);function m(e){return(0,c.Z)("MuiDivider",e)}(0,a(6087).Z)("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]);var u=a(5893);const f=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],k=(0,p.ZP)("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,a.absolute&&t.absolute,t[a.variant],a.light&&t.light,"vertical"===a.orientation&&t.vertical,a.flexItem&&t.flexItem,a.children&&t.withChildren,a.children&&"vertical"===a.orientation&&t.withChildrenVertical,"right"===a.textAlign&&"vertical"!==a.orientation&&t.textAlignRight,"left"===a.textAlign&&"vertical"!==a.orientation&&t.textAlignLeft]}})((({theme:e,ownerState:t})=>(0,r.Z)({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:e.palette.divider,borderBottomWidth:"thin"},t.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},t.light&&{borderColor:(0,l.Fq)(e.palette.divider,.08)},"inset"===t.variant&&{marginLeft:72},"middle"===t.variant&&"horizontal"===t.orientation&&{marginLeft:e.spacing(2),marginRight:e.spacing(2)},"middle"===t.variant&&"vertical"===t.orientation&&{marginTop:e.spacing(1),marginBottom:e.spacing(1)},"vertical"===t.orientation&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},t.flexItem&&{alignSelf:"stretch",height:"auto"})),(({theme:e,ownerState:t})=>(0,r.Z)({},t.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,"&::before, &::after":{position:"relative",width:"100%",borderTop:`thin solid ${e.palette.divider}`,top:"50%",content:'""',transform:"translateY(50%)"}})),(({theme:e,ownerState:t})=>(0,r.Z)({},t.children&&"vertical"===t.orientation&&{flexDirection:"column","&::before, &::after":{height:"100%",top:"0%",left:"50%",borderTop:0,borderLeft:`thin solid ${e.palette.divider}`,transform:"translateX(0%)"}})),(({ownerState:e})=>(0,r.Z)({},"right"===e.textAlign&&"vertical"!==e.orientation&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},"left"===e.textAlign&&"vertical"!==e.orientation&&{"&::before":{width:"10%"},"&::after":{width:"90%"}}))),N=(0,p.ZP)("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.wrapper,"vertical"===a.orientation&&t.wrapperVertical]}})((({theme:e,ownerState:t})=>(0,r.Z)({display:"inline-block",paddingLeft:`calc(${e.spacing(1)} * 1.2)`,paddingRight:`calc(${e.spacing(1)} * 1.2)`},"vertical"===t.orientation&&{paddingTop:`calc(${e.spacing(1)} * 1.2)`,paddingBottom:`calc(${e.spacing(1)} * 1.2)`})));var y=o.forwardRef((function(e,t){const a=(0,d.Z)({props:e,name:"MuiDivider"}),{absolute:o=!1,children:l,className:p,component:c=(l?"div":"hr"),flexItem:y=!1,light:h=!1,orientation:_="horizontal",role:C=("hr"!==c?"separator":void 0),textAlign:v="center",variant:g="fullWidth"}=a,b=(0,n.Z)(a,f),E=(0,r.Z)({},a,{absolute:o,component:c,flexItem:y,light:h,orientation:_,role:C,textAlign:v,variant:g}),w=(e=>{const{absolute:t,children:a,classes:n,flexItem:r,light:o,orientation:s,textAlign:l,variant:p}=e,d={root:["root",t&&"absolute",p,o&&"light","vertical"===s&&"vertical",r&&"flexItem",a&&"withChildren",a&&"vertical"===s&&"withChildrenVertical","right"===l&&"vertical"!==s&&"textAlignRight","left"===l&&"vertical"!==s&&"textAlignLeft"],wrapper:["wrapper","vertical"===s&&"wrapperVertical"]};return(0,i.Z)(d,m,n)})(E);return(0,u.jsx)(k,(0,r.Z)({as:c,className:(0,s.Z)(w.root,p),role:C,ref:t,ownerState:E},b,{children:l?(0,u.jsx)(N,{className:w.wrapper,ownerState:E,children:l}):null}))}))},2967:function(e,t,a){a.d(t,{z:function(){return sa}});var n=a(9960),r=a(7462),o=a(3366),s=a(7294),i=a(3905),l=a(9373),p=["components"],d={toc:[]};function c(e){var t=e.components,a=(0,o.Z)(e,p);return(0,i.kt)("wrapper",(0,r.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Associates an ",(0,i.kt)("i",null,"owner")," address and a ",(0,i.kt)("i",null,"spender")," address to an amount of tokens."),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"asset allowance identified by addr_owner addr_spender to big_map {\n  addr_owner       : address;\n  addr_spender     : address;\n  amount           : nat;\n}\n")))}c.isMDXComponent=!0;var m=["components"],u={toc:[]};function f(e){var t=e.components,a=(0,o.Z)(e,m);return(0,i.kt)("wrapper",(0,r.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Approves ",(0,i.kt)("inlineCode",{parentName:"p"},"spender")," to transfer ",(0,i.kt)("inlineCode",{parentName:"p"},"value")," tokens owned by ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#caller"},(0,i.kt)("inlineCode",{parentName:"a"},"caller")),"."),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},'entry approve(spender : address, value : nat) {\n  const previous = ledger[caller] ? (the.allowance[spender] ? the : 0) : 0;\n  do_fail_if(previous > 0 and value > 0, (("UnsafeAllowanceChange", previous)));\n  ledger.add_update(caller, { allowance += [(spender, value)] });\n}\n')),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/localvariable#const"},(0,i.kt)("inlineCode",{parentName:"a"},"const"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keya"},(0,i.kt)("inlineCode",{parentName:"a"},"[]"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/controls#a--b--c"},(0,i.kt)("inlineCode",{parentName:"a"},"?:"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/divergent#do_fail_ift--bool-e--t"},(0,i.kt)("inlineCode",{parentName:"a"},"do_fail_if"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-11"},(0,i.kt)("inlineCode",{parentName:"a"},">"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/containers#mputk-v"},(0,i.kt)("inlineCode",{parentName:"a"},"put"))))}f.isMDXComponent=!0;var k=["components"],N={toc:[]};function y(e){var t=e.components,a=(0,o.Z)(e,k);return(0,i.kt)("wrapper",(0,r.Z)({},N,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Getter of the allowed value ",(0,i.kt)("inlineCode",{parentName:"p"},"spender")," can transfer on behalf of ",(0,i.kt)("inlineCode",{parentName:"p"},"owner"),"."),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"getter getAllowance (owner : address, spender : address) : nat {\n  return (ledger[owner] ? (the.allowance[spender] ? the : 0) : 0)\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#getter"},(0,i.kt)("inlineCode",{parentName:"a"},"getter"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keya"},(0,i.kt)("inlineCode",{parentName:"a"},"[]"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/controls#a--b--c"},(0,i.kt)("inlineCode",{parentName:"a"},"?:"))))}y.isMDXComponent=!0;var h=["components"],_={toc:[]};function C(e){var t=e.components,a=(0,o.Z)(e,h);return(0,i.kt)("wrapper",(0,r.Z)({},_,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Getter of the number of tokens owned by ",(0,i.kt)("inlineCode",{parentName:"p"},"owner"),"."),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"getter getBalance (owner : address) : nat {\n  return (ledger[owner] ? the.tokens : 0)\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#getter"},(0,i.kt)("inlineCode",{parentName:"a"},"getter"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keya"},(0,i.kt)("inlineCode",{parentName:"a"},"[]"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/controls#a--b--c"},(0,i.kt)("inlineCode",{parentName:"a"},"?:"))))}C.isMDXComponent=!0;var v=["components"],g={toc:[]};function b(e){var t=e.components,a=(0,o.Z)(e,v);return(0,i.kt)("wrapper",(0,r.Z)({},g,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Getter of ",(0,i.kt)("a",{parentName:"p",href:"/docs/templates/fa12#total_supply"},(0,i.kt)("inlineCode",{parentName:"a"},"total_supply")),"."),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"getter getTotalSupply () : nat {\n  return total_supply\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#getter"},(0,i.kt)("inlineCode",{parentName:"a"},"getter"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))))}b.isMDXComponent=!0;var E=["components"],w={toc:[]};function x(e){var t=e.components,a=(0,o.Z)(e,E);return(0,i.kt)("wrapper",(0,r.Z)({},w,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Associates an address to:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"tokens")," the number of tokens it owns"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"allowance")," that associates a ",(0,i.kt)("i",null,"spender")," address to the quantity it is allowed to spend")),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"asset ledger identified by holder to big_map {\n  holder     : address;\n  tokens     : nat = 0;\n  allowance  : map<address, nat> = [];\n} initialized with {\n  { holder = caller; tokens = total_supply }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/storage#asset"},(0,i.kt)("inlineCode",{parentName:"a"},"asset"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#map%3CK,%20V%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"map"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#caller"},(0,i.kt)("inlineCode",{parentName:"a"},"caller"))))}x.isMDXComponent=!0;var Z=["components"],T={toc:[]};function D(e){var t=e.components,a=(0,o.Z)(e,Z);return(0,i.kt)("wrapper",(0,r.Z)({},T,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Transfers ",(0,i.kt)("inlineCode",{parentName:"p"},"value")," tokens from ",(0,i.kt)("inlineCode",{parentName:"p"},"from")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"to"),"."),(0,i.kt)("p",null,"If the caller is not equal to ",(0,i.kt)("inlineCode",{parentName:"p"},"from"),", then ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#caller"},(0,i.kt)("inlineCode",{parentName:"a"},"caller"))," must have been allowed by from to transfer this amount to ",(0,i.kt)("inlineCode",{parentName:"p"},"to")),(0,i.kt)("p",null,"Approved amount is decreased by ",(0,i.kt)("inlineCode",{parentName:"p"},"value")," if applicable."),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},'entry %transfer (%from : address, %to : address, value : nat) {\n  require {\n    r1 : ledger[%from].tokens >= value otherwise "NotEnoughBalance";\n  }\n  effect {\n    if caller <> %from then begin\n      const current = ledger[%from].allowance[caller] ? the : 0;\n      const new_value ?=\n        int_to_nat(current - value) : ("NotEnoughAllowance", ((value, current)));\n      ledger[%from].allowance.put(caller, new_value);\n    end;\n    ledger.update(%from,   { tokens -= value });\n    ledger.add_update(%to, { tokens += value });\n  }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keyaf"},(0,i.kt)("inlineCode",{parentName:"a"},"[]."))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-12"},(0,i.kt)("inlineCode",{parentName:"a"},">="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#if"},(0,i.kt)("inlineCode",{parentName:"a"},"if"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#caller"},(0,i.kt)("inlineCode",{parentName:"a"},"caller"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-8"},(0,i.kt)("inlineCode",{parentName:"a"},"<>"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/sequence"},(0,i.kt)("inlineCode",{parentName:"a"},"begin"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/localvariable#const"},(0,i.kt)("inlineCode",{parentName:"a"},"const"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/controls#a--b--c"},(0,i.kt)("inlineCode",{parentName:"a"},"?:"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/localvariable#"},(0,i.kt)("inlineCode",{parentName:"a"},"?="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#int_to_nat(i%20:%20int)"},(0,i.kt)("inlineCode",{parentName:"a"},"into_to_nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/containers#mputk-v"},(0,i.kt)("inlineCode",{parentName:"a"},"put"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aupdatek--u-"},(0,i.kt)("inlineCode",{parentName:"a"},"update"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aadd_updatek--u-"},(0,i.kt)("inlineCode",{parentName:"a"},"add_update"))))}D.isMDXComponent=!0;var I=a(5488),P=a(5162),A=["components"],M={toc:[]};function L(e){var t=e.components,a=(0,o.Z)(e,A);return(0,i.kt)("wrapper",(0,r.Z)({},M,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"record balance_of_request {\n  bo_owner : address;\n  btoken_id : nat;\n} as ((owner, token_id))\n\nrecord balance_of_response {\n  request : balance_of_request;\n  balance_ : nat;\n} as ((request, balance))\n")),(0,i.kt)(I.Z,{defaultValue:"NFT",mdxType:"Tabs"},(0,i.kt)(P.Z,{value:"NFT",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"getter balance_of (requests : list<balance_of_request>) : list<balance_of_response> {\n  return map(requests, br -> {\n    request = br;\n    balance_ = (ledger[br.btoken_id] ? (the.lowner = br.bo_owner ? 1 : 0) : 0)\n  })\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/language-basics/composite#record"},(0,i.kt)("inlineCode",{parentName:"a"},"record"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#getter"},(0,i.kt)("inlineCode",{parentName:"a"},"getter"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#list%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"list"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#map"},(0,i.kt)("inlineCode",{parentName:"a"},"map"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keya"},(0,i.kt)("inlineCode",{parentName:"a"},"[]"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/controls#a--b--c"},(0,i.kt)("inlineCode",{parentName:"a"},"?:")))),(0,i.kt)(P.Z,{value:"Fungible",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"getter balance_of (requests : list<balance_of_request>) : list<balance_of_response> {\n  return map(requests, br ->\n    let b =\n      if br.btoken_id <> TOKEN_ID then 0\n      else (ledger[br.bo_owner] ? the.lamount : 0) in\n    {\n      request = br;\n      balance_ = b\n    })\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/language-basics/composite#record"},(0,i.kt)("inlineCode",{parentName:"a"},"record"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#getter"},(0,i.kt)("inlineCode",{parentName:"a"},"getter"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#list%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"list"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#map"},(0,i.kt)("inlineCode",{parentName:"a"},"map"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keya"},(0,i.kt)("inlineCode",{parentName:"a"},"[]"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/controls#a--b--c"},(0,i.kt)("inlineCode",{parentName:"a"},"?:")))),(0,i.kt)(P.Z,{value:"Multi asset",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"getter balance_of (requests : list<balance_of_request>) : list<balance_of_response> {\n  return map(requests, br ->\n    let b =\n      if br.btoken_id <> TOKEN_ID then 0\n      else (ledger[(br.bo_owner, br.btoken_id)] ? the.lamount : 0) in\n    {\n      request = br;\n      balance_ = b\n    })\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/language-basics/composite#record"},(0,i.kt)("inlineCode",{parentName:"a"},"record"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#getter"},(0,i.kt)("inlineCode",{parentName:"a"},"getter"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#list%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"list"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#map"},(0,i.kt)("inlineCode",{parentName:"a"},"map"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keya"},(0,i.kt)("inlineCode",{parentName:"a"},"[]"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/controls#a--b--c"},(0,i.kt)("inlineCode",{parentName:"a"},"?:"))))))}L.isMDXComponent=!0;var q=["components"],X={toc:[]};function S(e){var t=e.components,a=(0,o.Z)(e,q);return(0,i.kt)("wrapper",(0,r.Z)({},X,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry burn(nbt : nat) {\n  constant {\n    amount ?is ledger[caller]?.lamount otherwise FA2_INSUFFICIENT_BALANCE\n  }\n  require {\n    fa2_r6: is_not_paused();\n    fa2_r7: amount >= nbt otherwise FA2_INSUFFICIENT_BALANCE\n  }\n  effect {\n    if (amount > nbt) then\n      ledger.update(caller, { lamount -= nbt })\n    else ledger.remove(caller)\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#constant"},(0,i.kt)("inlineCode",{parentName:"a"},"constant"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keyaf-1"},(0,i.kt)("inlineCode",{parentName:"a"},"?."))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-12"},(0,i.kt)("inlineCode",{parentName:"a"},">="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#caller"},(0,i.kt)("inlineCode",{parentName:"a"},"caller"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aupdatek--u-"},(0,i.kt)("inlineCode",{parentName:"a"},"update"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aremovek"},(0,i.kt)("inlineCode",{parentName:"a"},"remove"))))}S.isMDXComponent=!0;var F=["components"],R={toc:[]};function z(e){var t=e.components,a=(0,o.Z)(e,F);return(0,i.kt)("wrapper",(0,r.Z)({},R,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry burn(tid : nat, nbt : nat) {\n  constant {\n    amount ?is ledger[(caller, tid)]?.lamount otherwise FA2_INSUFFICIENT_BALANCE\n  }\n  require {\n    fa2_r6: is_not_paused();\n    fa2_r7: amount >= nbt otherwise FA2_INSUFFICIENT_BALANCE\n  }\n  effect {\n    if (amount > nbt) then\n      ledger.update((caller, tid), { lamount -= nbt })\n    else ledger.remove((caller, tid))\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#constant"},(0,i.kt)("inlineCode",{parentName:"a"},"constant"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keyaf-1"},(0,i.kt)("inlineCode",{parentName:"a"},"?."))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-12"},(0,i.kt)("inlineCode",{parentName:"a"},">="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#caller"},(0,i.kt)("inlineCode",{parentName:"a"},"caller"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aupdatek--u-"},(0,i.kt)("inlineCode",{parentName:"a"},"update"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aremovek"},(0,i.kt)("inlineCode",{parentName:"a"},"remove"))))}z.isMDXComponent=!0;var O=["components"],U={toc:[]};function W(e){var t=e.components,a=(0,o.Z)(e,O);return(0,i.kt)("wrapper",(0,r.Z)({},U,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry burn(tid : nat) {\n  constant {\n    token_owner ?is ledger[tid]?.lowner otherwise FA2_TOKEN_UNDEFINED;\n  }\n  require {\n    fa2_r6: is_not_paused();\n    fa2_r7: token_owner = caller otherwise CALLER_NOT_OWNER\n  }\n  effect {\n    ledger.remove(tid);\n    token_metadata.remove(tid);\n    royalties.remove(tid)\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#constant"},(0,i.kt)("inlineCode",{parentName:"a"},"constant"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keyaf-1"},(0,i.kt)("inlineCode",{parentName:"a"},"?."))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-7"},(0,i.kt)("inlineCode",{parentName:"a"},"="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#caller"},(0,i.kt)("inlineCode",{parentName:"a"},"caller"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aremovek"},(0,i.kt)("inlineCode",{parentName:"a"},"remove"))))}W.isMDXComponent=!0;var B=["components"],V={toc:[]};function K(e){var t=e.components,a=(0,o.Z)(e,B);return(0,i.kt)("wrapper",(0,r.Z)({},V,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"function check_operator(txs : list<transfer_param>) : bool {\n  var res = true;\n  for tx in txs do\n    const %from = tx.tp_from;\n    const tds = tx.tp_txs;\n    for td in tds do begin\n      res &=\n        if caller <> %from then\n          (operator.contains((caller, td.token_id_dest, %from)) or\n           operator_for_all.contains((caller, %from)))\n        else\n          true;\n    end\n    done\n  done;\n  return res\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/function"},(0,i.kt)("inlineCode",{parentName:"a"},"function"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#list%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"list"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#bool"},(0,i.kt)("inlineCode",{parentName:"a"},"bool"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/localvariable#var"},(0,i.kt)("inlineCode",{parentName:"a"},"var"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#for"},(0,i.kt)("inlineCode",{parentName:"a"},"for"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/localvariable#const"},(0,i.kt)("inlineCode",{parentName:"a"},"const"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#if"},(0,i.kt)("inlineCode",{parentName:"a"},"if"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/sequence"},(0,i.kt)("inlineCode",{parentName:"a"},"begin")),"  ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/access#ab-1"},(0,i.kt)("inlineCode",{parentName:"a"},"."))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/assignment#a--b-4"},(0,i.kt)("inlineCode",{parentName:"a"},"&="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a-or-b"},(0,i.kt)("inlineCode",{parentName:"a"},"or"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-8"},(0,i.kt)("inlineCode",{parentName:"a"},"<>"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#acontainsk--asset_keya"},(0,i.kt)("inlineCode",{parentName:"a"},"contains"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#caller"},(0,i.kt)("inlineCode",{parentName:"a"},"caller"))))}K.isMDXComponent=!0;var j=["components"],G={toc:[]};function Y(e){var t=e.components,a=(0,o.Z)(e,j);return(0,i.kt)("wrapper",(0,r.Z)({},G,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Called by ",(0,i.kt)("a",{parentName:"p",href:"/docs/templates/fa2#transfertxs-"},(0,i.kt)("inlineCode",{parentName:"a"},"transfer"))," and ",(0,i.kt)("a",{parentName:"p",href:"/docs/templates/fa2#transfer_gaslessbatch"},(0,i.kt)("inlineCode",{parentName:"a"},"transfer_gasless"))," to actually execute the transfer of tokens (that is to update ",(0,i.kt)("a",{parentName:"p",href:"/docs/templates/fa2#ledger-"},(0,i.kt)("inlineCode",{parentName:"a"},"ledger"))," collection). It is assumed here that operator or permits' authorization rules have been applied."),(0,i.kt)("p",null,"Note that it may only be called by the contract itself."),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)(I.Z,{defaultValue:"NFT",mdxType:"Tabs"},(0,i.kt)(P.Z,{value:"NFT",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry do_transfer(txs : list<transfer_param>) {\n  called by self_address\n  effect {\n    for tx in txs do\n      const %from = tx.tp_from;\n      const tds   = tx.tp_txs;\n      for td in tds do begin\n        const tokenid = td.token_id_dest;\n        const towner ?= ledger[tokenid]?.lowner : FA2_TOKEN_UNDEFINED;\n        do_require(towner = %from and td.token_amount_dest = 1,\n          FA2_INSUFFICIENT_BALANCE);\n        ledger.update(tokenid, { lowner = td.to_dest });\n      end done\n    done\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#list%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"list"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#called-by"},(0,i.kt)("inlineCode",{parentName:"a"},"called by"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#self_address"},(0,i.kt)("inlineCode",{parentName:"a"},"self_address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#for"},(0,i.kt)("inlineCode",{parentName:"a"},"for"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/localvariable#const"},(0,i.kt)("inlineCode",{parentName:"a"},"const"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/access#ab-1"},(0,i.kt)("inlineCode",{parentName:"a"},"."))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/localvariable#"},(0,i.kt)("inlineCode",{parentName:"a"},"?="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keyaf-1"},(0,i.kt)("inlineCode",{parentName:"a"},"?."))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/divergent#do_requiret--bool-e--t"},(0,i.kt)("inlineCode",{parentName:"a"},"do_require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-7"},(0,i.kt)("inlineCode",{parentName:"a"},"="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aupdatek--u-"},(0,i.kt)("inlineCode",{parentName:"a"},"update")))),(0,i.kt)(P.Z,{value:"Fungible",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry do_transfer(txs : list<transfer_param>) {\n  called by self_address\n  effect {\n    for tx in txs do\n      const %from = tx.tp_from;\n      const tds   = tx.tp_txs;\n      for td in tds do begin\n        do_require(td.token_id_dest = TOKEN_ID, FA2_TOKEN_UNDEFINED);\n        const amount = ledger[%from]?.lamount ? the : 0;\n        const new_amount ?=\n            int_to_nat(amount - td.token_amount_dest) : FA2_INSUFFICIENT_BALANCE;\n        if new_amount = 0 then\n          ledger.remove(%from)\n        else begin\n          ledger.update(%from, { lamount := new_amount });\n        end;\n        ledger.add_update(td.to_dest, { lamount += td.token_amount_dest })\n      end done\n    done\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#list%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"list"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#called-by"},(0,i.kt)("inlineCode",{parentName:"a"},"called by"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#self_address"},(0,i.kt)("inlineCode",{parentName:"a"},"self_address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#for"},(0,i.kt)("inlineCode",{parentName:"a"},"for"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/localvariable#const"},(0,i.kt)("inlineCode",{parentName:"a"},"const"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/access#ab-1"},(0,i.kt)("inlineCode",{parentName:"a"},"."))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/localvariable#"},(0,i.kt)("inlineCode",{parentName:"a"},"?="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keyaf-1"},(0,i.kt)("inlineCode",{parentName:"a"},"?."))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/divergent#do_requiret--bool-e--t"},(0,i.kt)("inlineCode",{parentName:"a"},"do_require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-7"},(0,i.kt)("inlineCode",{parentName:"a"},"="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-12"},(0,i.kt)("inlineCode",{parentName:"a"},">="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-8"},(0,i.kt)("inlineCode",{parentName:"a"},"<>"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/sequence"},(0,i.kt)("inlineCode",{parentName:"a"},"begin"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#int_to_nat(i%20:%20int)"},(0,i.kt)("inlineCode",{parentName:"a"},"into_to_nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aupdatek--u-"},(0,i.kt)("inlineCode",{parentName:"a"},"update"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aadd_updatek--u-"},(0,i.kt)("inlineCode",{parentName:"a"},"add_update"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aremovek"},(0,i.kt)("inlineCode",{parentName:"a"},"remove")))),(0,i.kt)(P.Z,{value:"Multi asset",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry do_transfer(txs : list<transfer_param>) {\n  called by self_address\n  effect {\n    for tx in txs do\n      const %from = tx.tp_from;\n      const tds   = tx.tp_txs;\n      for td in tds do begin\n        const tid = td.token_id_dest;\n        const amount = ledger[(%from, tid)]?.lamount ? the : 0;\n        const new_amount ?=\n            int_to_nat(amount - td.token_amount_dest) : FA2_INSUFFICIENT_BALANCE;\n        if new_amount = 0 then\n          ledger.remove((%from, tid))\n        else begin\n          ledger.update((%from, tid), { lamount := new_amount });\n        end;\n        ledger.add_update((td.to_dest, tid), { lamount += td.token_amount_dest })\n      end done\n    done\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#list%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"list"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#called-by"},(0,i.kt)("inlineCode",{parentName:"a"},"called by"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#self_address"},(0,i.kt)("inlineCode",{parentName:"a"},"self_address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#for"},(0,i.kt)("inlineCode",{parentName:"a"},"for"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/localvariable#const"},(0,i.kt)("inlineCode",{parentName:"a"},"const"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/access#ab-1"},(0,i.kt)("inlineCode",{parentName:"a"},"."))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/localvariable#"},(0,i.kt)("inlineCode",{parentName:"a"},"?="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keyaf-1"},(0,i.kt)("inlineCode",{parentName:"a"},"?."))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/divergent#do_requiret--bool-e--t"},(0,i.kt)("inlineCode",{parentName:"a"},"do_require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-7"},(0,i.kt)("inlineCode",{parentName:"a"},"="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-12"},(0,i.kt)("inlineCode",{parentName:"a"},">="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-8"},(0,i.kt)("inlineCode",{parentName:"a"},"<>"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/sequence"},(0,i.kt)("inlineCode",{parentName:"a"},"begin"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#int_to_nat(i%20:%20int)"},(0,i.kt)("inlineCode",{parentName:"a"},"into_to_nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aupdatek--u-"},(0,i.kt)("inlineCode",{parentName:"a"},"update"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aadd_updatek--u-"},(0,i.kt)("inlineCode",{parentName:"a"},"add_update"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aremovek"},(0,i.kt)("inlineCode",{parentName:"a"},"remove"))))))}Y.isMDXComponent=!0;var H=["components"],$={toc:[]};function J(e){var t=e.components,a=(0,o.Z)(e,H);return(0,i.kt)("wrapper",(0,r.Z)({},$,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"function get_from(txs : list<transfer_param>) : option<address> {\n  match txs with\n  | hd::tl -> begin\n    const %from = hd.tp_from;\n    for tx in tl do\n      do_require(%from = tx.tp_from, FA2_NOT_OPERATOR)\n    done;\n    return some(%from)\n  end\n  | [] -> return none\n  end\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/function"},(0,i.kt)("inlineCode",{parentName:"a"},"function"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#list%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"list"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#option%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"option"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#match-with"},(0,i.kt)("inlineCode",{parentName:"a"},"match"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/sequence"},(0,i.kt)("inlineCode",{parentName:"a"},"begin"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/localvariable#const"},(0,i.kt)("inlineCode",{parentName:"a"},"const"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/access#ab-1"},(0,i.kt)("inlineCode",{parentName:"a"},"."))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#for"},(0,i.kt)("inlineCode",{parentName:"a"},"for"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/divergent#do_requiret--bool-e--t"},(0,i.kt)("inlineCode",{parentName:"a"},"do_require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-7"},(0,i.kt)("inlineCode",{parentName:"a"},"="))))}J.isMDXComponent=!0;var Q=["components"],ee={toc:[]};function te(e){var t=e.components,a=(0,o.Z)(e,Q);return(0,i.kt)("wrapper",(0,r.Z)({},ee,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"view get_royalties(tokenId : nat) : list<part> {\n  return (royalties[tokenId] ? the.rvalue : make_list<part>([]))\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/view"},(0,i.kt)("inlineCode",{parentName:"a"},"view"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#list%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"list"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keya"},(0,i.kt)("inlineCode",{parentName:"a"},"[]"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/controls#a--b--c"},(0,i.kt)("inlineCode",{parentName:"a"},"?:"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#make_list%3CT%3E(l)"},(0,i.kt)("inlineCode",{parentName:"a"},"make_list"))))}te.isMDXComponent=!0;var ae=["components"],ne={toc:[]};function re(e){var t=e.components,a=(0,o.Z)(e,ae);return(0,i.kt)("wrapper",(0,r.Z)({},ne,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ledger")," associates an account to the number of tokens it owns."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"asset ledger to big_map {\n  lowner     : address;\n  lamount    : nat = 0;\n} initialized with {\n  {owner; INITIAL_TOTAL_SUPPLY}\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/asset"},(0,i.kt)("inlineCode",{parentName:"a"},"asset"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))))}re.isMDXComponent=!0;var oe=["components"],se={toc:[]};function ie(e){var t=e.components,a=(0,o.Z)(e,oe);return(0,i.kt)("wrapper",(0,r.Z)({},se,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ledger")," associates an account ",(0,i.kt)("em",{parentName:"p"},"and")," a token id to the number of tokens it owns."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"asset ledger identified by lowner ltokenid to big_map {\n  lowner     : address;\n  ltokenid   : nat;\n  lamount    : nat = 0;\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/asset"},(0,i.kt)("inlineCode",{parentName:"a"},"asset"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Note that the asset is identified by the owner account ",(0,i.kt)("em",{parentName:"p"},"and")," token id."))))}ie.isMDXComponent=!0;var le=["components"],pe={toc:[]};function de(e){var t=e.components,a=(0,o.Z)(e,le);return(0,i.kt)("wrapper",(0,r.Z)({},pe,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"ledger")," associates an NFT id to its owner (",(0,i.kt)("em",{parentName:"p"},"not")," the other way round)."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"asset ledger to big_map {\n  ltokenid   : nat;\n  lowner     : address;\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/asset"},(0,i.kt)("inlineCode",{parentName:"a"},"asset"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))))}de.isMDXComponent=!0;var ce=["components"],me={toc:[]};function ue(e){var t=e.components,a=(0,o.Z)(e,ce);return(0,i.kt)("wrapper",(0,r.Z)({},me,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry mint (tow : address, nbt : nat) {\n  called by owner\n  require { fa2_r5: is_not_paused() }\n  effect {\n    ledger.add_update(tow, { lamount += nbt });\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aadd_updatek--u-"},(0,i.kt)("inlineCode",{parentName:"a"},"add_update"))))}ue.isMDXComponent=!0;var fe=["components"],ke={toc:[]};function Ne(e){var t=e.components,a=(0,o.Z)(e,fe);return(0,i.kt)("wrapper",(0,r.Z)({},ke,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry mint (tow : address, tid : nat, nbt : nat) {\n  called by owner\n  require { fa2_r5: is_not_paused() }\n  effect {\n    ledger.add_update((tow, tid), { lamount += nbt });\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aadd_updatek--u-"},(0,i.kt)("inlineCode",{parentName:"a"},"add_update"))))}Ne.isMDXComponent=!0;var ye=["components"],he={toc:[]};function _e(e){var t=e.components,a=(0,o.Z)(e,ye);return(0,i.kt)("wrapper",(0,r.Z)({},he,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry mint (tow : address, tid : nat, tmd: map<string, bytes>, roy : list<part>) {\n  called by owner\n  require { fa2_r5: is_not_paused() }\n  effect {\n    ledger.add({ ltokenid = tid; lowner = tow });\n    token_metadata.add_update(tid, {\n      token_id   = tid;\n      token_info = tmd\n    });\n    royalties.put({ rtokenid = tid; rvalue = roy });\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#map%3CK,%20V%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"map"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#string"},(0,i.kt)("inlineCode",{parentName:"a"},"string"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#bytes"},(0,i.kt)("inlineCode",{parentName:"a"},"bytes"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#list%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"list"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aadda"},(0,i.kt)("inlineCode",{parentName:"a"},"add"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aadd_updatek--u-"},(0,i.kt)("inlineCode",{parentName:"a"},"add_update"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aputa"},(0,i.kt)("inlineCode",{parentName:"a"},"put"))))}_e.isMDXComponent=!0;var Ce=["components"],ve={toc:[]};function ge(e){var t=e.components,a=(0,o.Z)(e,Ce);return(0,i.kt)("wrapper",(0,r.Z)({},ve,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"asset operator_for_all identified by fa_oaddr fa_oowner to big_map {\n  fa_oaddr    : address;\n  fa_oowner   : address;\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/asset"},(0,i.kt)("inlineCode",{parentName:"a"},"asset"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#unit"},(0,i.kt)("inlineCode",{parentName:"a"},"unit"))))}ge.isMDXComponent=!0;var be=["components"],Ee={toc:[]};function we(e){var t=e.components,a=(0,o.Z)(e,be);return(0,i.kt)("wrapper",(0,r.Z)({},Ee,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"asset operator identified by oaddr otoken oowner to big_map {\n  oaddr       : address;\n  otoken      : nat;\n  oowner      : address;\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/asset"},(0,i.kt)("inlineCode",{parentName:"a"},"asset"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#unit"},(0,i.kt)("inlineCode",{parentName:"a"},"unit"))))}we.isMDXComponent=!0;var xe=["components"],Ze={toc:[]};function Te(e){var t=e.components,a=(0,o.Z)(e,xe);return(0,i.kt)("wrapper",(0,r.Z)({},Ze,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"record part {\n  part_account : address;\n  part_value   : nat;\n}\n\nasset royalties identified by rtokenid to big_map {\n  rtokenid : nat;\n  rvalue : list<part>;\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/language-basics/composite#record"},(0,i.kt)("inlineCode",{parentName:"a"},"record"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/asset"},(0,i.kt)("inlineCode",{parentName:"a"},"asset"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#list%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"list"))))}Te.isMDXComponent=!0;var De=["components"],Ie={toc:[]};function Pe(e){var t=e.components,a=(0,o.Z)(e,De);return(0,i.kt)("wrapper",(0,r.Z)({},Ie,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"record transfer_destination {\n  to_dest           : address;\n  token_id_dest     : nat;\n  token_amount_dest : nat\n} as ((%to_, (token_id, amount)))\n\nrecord transfer_param {\n  tp_from : address;\n  tp_txs  : list<transfer_destination>;\n} as ((%from_, %txs))\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/language-basics/composite#record"},(0,i.kt)("inlineCode",{parentName:"a"},"record"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#list%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"list"))))}Pe.isMDXComponent=!0;var Ae=["components"],Me={toc:[]};function Le(e){var t=e.components,a=(0,o.Z)(e,Ae);return(0,i.kt)("wrapper",(0,r.Z)({},Me,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"record gasless_param {\n  transfer_params : list<transfer_param>;\n  user_pk         : key;\n  user_sig        : signature\n}\n\nfunction check_owner(addr : address, txs : list<transfer_param>) : bool {\n  var res = true;\n  for tx in txs do\n    res &= addr = tx.tp_from\n  done;\n  return res\n}\n\nentry transfer_gasless (batch : list<gasless_param>) {\n  require { fa2_r3 : is_not_paused() }\n  effect {\n    for b in batch do\n      const txs = b.transfer_params;\n      const pk  = b.user_pk;\n      const sig = b.user_sig;\n      const pkh_signer = key_to_address(pk);\n      do_require(check_owner(pkh_signer, txs), SIGNER_NOT_FROM);\n      transfer 0tz to permits\n        call check<key * signature * bytes>((pk, sig, pack(txs)));\n      transfer 0tz to entry self.do_transfer(txs);\n    done\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/language-basics/composite#record"},(0,i.kt)("inlineCode",{parentName:"a"},"record"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#list%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"list"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#key"},(0,i.kt)("inlineCode",{parentName:"a"},"key"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#signature"},(0,i.kt)("inlineCode",{parentName:"a"},"signature"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#for"},(0,i.kt)("inlineCode",{parentName:"a"},"for"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/localvariable#const"},(0,i.kt)("inlineCode",{parentName:"a"},"const"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/operation#transfer"},(0,i.kt)("inlineCode",{parentName:"a"},"transfer"))))}Le.isMDXComponent=!0;var qe=["components"],Xe={toc:[]};function Se(e){var t=e.components,a=(0,o.Z)(e,qe);return(0,i.kt)("wrapper",(0,r.Z)({},Xe,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry %transfer (txs : list<transfer_param>) {\n  require { fa2_r4 : is_not_paused() }\n  effect {\n    if not check_operator(txs) then begin\n      match get_from(txs) with\n      | some(%from) ->\n        transfer 0tz to permits\n          call consume<address * bytes * string>((%from, pack(txs), FA2_NOT_OPERATOR))\n      | none -> ()\n      end\n    end;\n\n    transfer 0tz to entry self.do_transfer(txs);\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#list%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"list"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#if"},(0,i.kt)("inlineCode",{parentName:"a"},"if"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#match-with"},(0,i.kt)("inlineCode",{parentName:"a"},"match"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/operation#transfer"},(0,i.kt)("inlineCode",{parentName:"a"},"transfer"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#bytes"},(0,i.kt)("inlineCode",{parentName:"a"},"bytes")),"  ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#string"},(0,i.kt)("inlineCode",{parentName:"a"},"string"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#pack(o%20:%20T)"},(0,i.kt)("inlineCode",{parentName:"a"},"pack"))))}Se.isMDXComponent=!0;var Fe=["components"],Re={toc:[]};function ze(e){var t=e.components,a=(0,o.Z)(e,Fe);return(0,i.kt)("wrapper",(0,r.Z)({},Re,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"enum update_for_all_op =\n| add_for_all<address>\n| remove_for_all<address>\n\nentry update_operators_for_all (upl : list<update_for_all_op>) {\n  require { fa2_r2 : is_not_paused() }\n  effect {\n    for up in upl do\n      match up with\n      | add_for_all(op)  ->\n        operator_for_all.put({ op; caller})\n      | remove_for_all(op) ->\n        operator_for_all.remove((op, caller))\n      end;\n    done;\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/language-basics/composite#enum"},(0,i.kt)("inlineCode",{parentName:"a"},"enum"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#list%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"list"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#for"},(0,i.kt)("inlineCode",{parentName:"a"},"for"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#match-with"},(0,i.kt)("inlineCode",{parentName:"a"},"match"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/divergent#do_requiret--bool-e--t"},(0,i.kt)("inlineCode",{parentName:"a"},"do_require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aputa"},(0,i.kt)("inlineCode",{parentName:"a"},"put"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aremovek"},(0,i.kt)("inlineCode",{parentName:"a"},"remove"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#caller"},(0,i.kt)("inlineCode",{parentName:"a"},"caller"))))}ze.isMDXComponent=!0;var Oe=["components"],Ue={toc:[]};function We(e){var t=e.components,a=(0,o.Z)(e,Oe);return(0,i.kt)("wrapper",(0,r.Z)({},Ue,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"record operator_param {\n  opp_owner    : address;\n  opp_operator : address;\n  opp_token_id : nat\n} as ((owner, (operator, token_id)))\n\nenum update_op =\n| add_operator<operator_param>\n| remove_operator<operator_param>\n\nentry update_operators (upl : list<update_op>) {\n  require { fa2_r1 : is_not_paused() }\n  effect {\n    for up in upl do\n      match up with\n      | add_operator(param) ->\n        do_require(param.opp_owner = caller , CALLER_NOT_OWNER);\n        operator.put({ param.opp_operator; param.opp_token_id; param.opp_owner })\n      | remove_operator(param) ->\n        do_require(param.opp_owner = caller , CALLER_NOT_OWNER);\n        operator.remove((param.opp_operator, param.opp_token_id, param.opp_owner))\n      end;\n    done;\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/language-basics/composite#record"},(0,i.kt)("inlineCode",{parentName:"a"},"record"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/language-basics/composite#enum"},(0,i.kt)("inlineCode",{parentName:"a"},"enum"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#list%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"list"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#for"},(0,i.kt)("inlineCode",{parentName:"a"},"for"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#match-with"},(0,i.kt)("inlineCode",{parentName:"a"},"match"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/divergent#do_requiret--bool-e--t"},(0,i.kt)("inlineCode",{parentName:"a"},"do_require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aputa"},(0,i.kt)("inlineCode",{parentName:"a"},"put"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aremovek"},(0,i.kt)("inlineCode",{parentName:"a"},"remove"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#caller"},(0,i.kt)("inlineCode",{parentName:"a"},"caller"))))}We.isMDXComponent=!0;var Be=["components"],Ve={toc:[]};function Ke(e){var t=e.components,a=(0,o.Z)(e,Be);return(0,i.kt)("wrapper",(0,r.Z)({},Ve,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Adds or removes an entry to the ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/variables#metadata"},(0,i.kt)("inlineCode",{parentName:"a"},"metadata"))," map."),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"/* METADATA ---------------------------------------------------------------- */\n\nentry set_metadata(k: string, d : option<bytes>) {\n  called by owner\n  require { md_r1 : is_not_paused() }\n  effect {\n    metadata.update(k, d)\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#string"},(0,i.kt)("inlineCode",{parentName:"a"},"string"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#option%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"option"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#bytes"},(0,i.kt)("inlineCode",{parentName:"a"},"bytes"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#called-by"},(0,i.kt)("inlineCode",{parentName:"a"},"called by"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/variables#metadata"},(0,i.kt)("inlineCode",{parentName:"a"},"metadata"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/containers#mupdatek--k-o--optiont"},(0,i.kt)("inlineCode",{parentName:"a"},"update"))))}Ke.isMDXComponent=!0;var je=["components"],Ge={toc:[]};function Ye(e){var t=e.components,a=(0,o.Z)(e,je);return(0,i.kt)("wrapper",(0,r.Z)({},Ge,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Variable used during transfer of ownership to store the owner candidate address."),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"variable owner_candidate : option<address> = none\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/storage#variable"},(0,i.kt)("inlineCode",{parentName:"a"},"variable"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#option%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"option"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#none%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"none"))))}Ye.isMDXComponent=!0;var He=["components"],$e={toc:[]};function Je(e){var t=e.components,a=(0,o.Z)(e,He);return(0,i.kt)("wrapper",(0,r.Z)({},$e,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Declared candidate calls this method to confirm it is the new contract owner."),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},'entry claim_ownership() {\n  require {\n    ownership_r1: (owner_candidate ? the = caller : false) otherwise "INVALID_CALLER"\n  }\n  effect {\n    owner := caller;\n    owner_candidate := none\n  }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/controls#a--b--c"},(0,i.kt)("inlineCode",{parentName:"a"},"?:"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/assignment#a--b"},(0,i.kt)("inlineCode",{parentName:"a"},":="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#caller"},(0,i.kt)("inlineCode",{parentName:"a"},"caller"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#none"},(0,i.kt)("inlineCode",{parentName:"a"},"none"))))}Je.isMDXComponent=!0;var Qe=["components"],et={toc:[]};function tt(e){var t=e.components,a=(0,o.Z)(e,Qe);return(0,i.kt)("wrapper",(0,r.Z)({},et,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Declares a condidate address to be the contract's owner."),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry declare_ownership(candidate : address) {\n  called by owner\n  effect {\n    owner_candidate := some(candidate);\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#called-by"},(0,i.kt)("inlineCode",{parentName:"a"},"called by"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/assignment#a--b"},(0,i.kt)("inlineCode",{parentName:"a"},":="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#some(v%20:%20T)"},(0,i.kt)("inlineCode",{parentName:"a"},"some"))))}tt.isMDXComponent=!0;var at=["components"],nt={toc:[]};function rt(e){var t=e.components,a=(0,o.Z)(e,at);return(0,i.kt)("wrapper",(0,r.Z)({},nt,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Contract ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/contract#parameters"},"parameter")," for the contract owner."),(0,i.kt)("p",null,"It is typically used to protect an entrypoint against other callers with a ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#called-by"},(0,i.kt)("inlineCode",{parentName:"a"},"called by"))," section:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry exec() {\n  called by owner\n  /* ... */\n}\n")),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"archetype my_contract(owner : address)\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/contract"},(0,i.kt)("inlineCode",{parentName:"a"},"archetype"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))))}rt.isMDXComponent=!0;var ot=["components"],st={toc:[]};function it(e){var t=e.components,a=(0,o.Z)(e,ot);return(0,i.kt)("wrapper",(0,r.Z)({},st,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Utility function to call in ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," section of entrypoints, like in ",(0,i.kt)("a",{parentName:"p",href:"/docs/templates/pausable#pause"},(0,i.kt)("inlineCode",{parentName:"a"},"pause()"))," entrypoint below for example."),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},'function is_not_paused() : bool {\n  do_fail_if(paused, "CONTRACT_PAUSED");\n  return true\n}\n')),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/function"},(0,i.kt)("inlineCode",{parentName:"a"},"function"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/divergent#do_fail_ift--bool-e--t"},(0,i.kt)("inlineCode",{parentName:"a"},"do_fail_if"))))}it.isMDXComponent=!0;var lt=["components"],pt={toc:[]};function dt(e){var t=e.components,a=(0,o.Z)(e,lt);return(0,i.kt)("wrapper",(0,r.Z)({},pt,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Pauses contract when unpaused."),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry pause() {\n  called by owner\n  require {\n    pausable_r1: is_not_paused()\n  }\n  effect {\n    paused := true\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#called-by"},(0,i.kt)("inlineCode",{parentName:"a"},"called by"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect")),"  ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/assignment#a--b"},(0,i.kt)("inlineCode",{parentName:"a"},":="))))}dt.isMDXComponent=!0;var ct=["components"],mt={toc:[]};function ut(e){var t=e.components,a=(0,o.Z)(e,ct);return(0,i.kt)("wrapper",(0,r.Z)({},mt,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Contract's pausable state."),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"variable paused : bool = false\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/storage#variable"},(0,i.kt)("inlineCode",{parentName:"a"},"variable"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#bool"},(0,i.kt)("inlineCode",{parentName:"a"},"bool"))))}ut.isMDXComponent=!0;var ft=["components"],kt={toc:[]};function Nt(e){var t=e.components,a=(0,o.Z)(e,ft);return(0,i.kt)("wrapper",(0,r.Z)({},kt,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Unpauses contract when paused."),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},'entry unpause() {\n  called by owner\n  require {\n    pausable_r2: paused otherwise "CONTRACT_NOT_PAUSED"\n  }\n  effect {\n    paused := false\n  }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#called-by"},(0,i.kt)("inlineCode",{parentName:"a"},"called by"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect")),"  ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/assignment#a--b"},(0,i.kt)("inlineCode",{parentName:"a"},":="))))}Nt.isMDXComponent=!0;var yt=["components"],ht={toc:[]};function _t(e){var t=e.components,a=(0,o.Z)(e,yt);return(0,i.kt)("wrapper",(0,r.Z)({},ht,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry check(signer : key, sig : signature, data : bytes) {\n  called by consumer\n  constant {\n    user     is key_to_address(signer);\n    lcounter is permits[user] ? the.counter : 0;\n    to_sign  is pack(((self_address, self_chain_id), (lcounter, data)));\n  }\n  require {\n    p8: is_not_paused();\n    p9: check_signature(signer, sig, to_sign) otherwise (MISSIGNED, to_sign)\n  }\n  effect {\n    permits.add_update(user, { counter = (lcounter + 1)});\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#key"},(0,i.kt)("inlineCode",{parentName:"a"},"key"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#signature"},(0,i.kt)("inlineCode",{parentName:"a"},"signature"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#bytes"},(0,i.kt)("inlineCode",{parentName:"a"},"bytes"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#called-by"},(0,i.kt)("inlineCode",{parentName:"a"},"called by")),"  ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#constant"},(0,i.kt)("inlineCode",{parentName:"a"},"constant"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#key_to_address(k%20:%20key)"},(0,i.kt)("inlineCode",{parentName:"a"},"key_to_address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keya"},(0,i.kt)("inlineCode",{parentName:"a"},"[]"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/controls#a--b--c"},(0,i.kt)("inlineCode",{parentName:"a"},"?:"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#pack(o%20:%20T)"},(0,i.kt)("inlineCode",{parentName:"a"},"pack"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#self_address"},(0,i.kt)("inlineCode",{parentName:"a"},"self_address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#blake2b(b%20:%20bytes)"},(0,i.kt)("inlineCode",{parentName:"a"},"blake2b"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#check_signature(k%20:%20key,%20s%20:%20signature,%20b%20:%20bytes)"},(0,i.kt)("inlineCode",{parentName:"a"},"check_signature"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aadd_updatek--u-"},(0,i.kt)("inlineCode",{parentName:"a"},"add_update"))))}_t.isMDXComponent=!0;var Ct=["components"],vt={toc:[]};function gt(e){var t=e.components,a=(0,o.Z)(e,Ct);return(0,i.kt)("wrapper",(0,r.Z)({},vt,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry consume(user : address, data: bytes, err: string) {\n  called by consumer\n  constant {\n   permit_key     is blake2b(data);\n   signer_expiry  is get_expiry(user, permit_key);\n   lpermit       ?is permits[user]                    otherwise err;\n   luser_permits ?is lpermit.user_permits[permit_key] otherwise err;\n  }\n  require {\n    p6: is_not_paused()\n  }\n  fail if {\n    p7 : has_expired(luser_permits, signer_expiry) with (PERMIT_EXPIRED, ((luser_permits.created_at + (luser_permits.expiry ? the : signer_expiry) * 1s)))\n  }\n  effect {\n    permits[user].user_permits.remove(permit_key)\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#bytes"},(0,i.kt)("inlineCode",{parentName:"a"},"bytes"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#string"},(0,i.kt)("inlineCode",{parentName:"a"},"string"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#called-by"},(0,i.kt)("inlineCode",{parentName:"a"},"called by"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#constant"},(0,i.kt)("inlineCode",{parentName:"a"},"constant"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#blake2b(b%20:%20bytes)"},(0,i.kt)("inlineCode",{parentName:"a"},"blake2b"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keya"},(0,i.kt)("inlineCode",{parentName:"a"},"[]"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#fail-if"},(0,i.kt)("inlineCode",{parentName:"a"},"fail if"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/containers#mremovek"},(0,i.kt)("inlineCode",{parentName:"a"},"remove"))))}gt.isMDXComponent=!0;var bt=["components"],Et={toc:[]};function wt(e){var t=e.components,a=(0,o.Z)(e,bt);return(0,i.kt)("wrapper",(0,r.Z)({},Et,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"asset consumer {\n  cid : address\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/asset"},(0,i.kt)("inlineCode",{parentName:"a"},"asset"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))))}wt.isMDXComponent=!0;var xt=["components"],Zt={toc:[]};function Tt(e){var t=e.components,a=(0,o.Z)(e,xt);return(0,i.kt)("wrapper",(0,r.Z)({},Zt,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Default permits expiration duration set to one year (expressed in seconds)."),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"variable default_expiry : nat = 31556952\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/storage#variable"},(0,i.kt)("inlineCode",{parentName:"a"},"variable"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#duration"},(0,i.kt)("inlineCode",{parentName:"a"},"duration"))))}Tt.isMDXComponent=!0;var Dt=["components"],It={toc:[]};function Pt(e){var t=e.components,a=(0,o.Z)(e,Dt);return(0,i.kt)("wrapper",(0,r.Z)({},It,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"function get_default_expiry(addr : address) : nat {\n  return (permits[addr] ? (the.user_expiry ? the : default_expiry) : default_expiry)\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/function"},(0,i.kt)("inlineCode",{parentName:"a"},"function"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/controls#a--b--c"},(0,i.kt)("inlineCode",{parentName:"a"},"?:"))))}Pt.isMDXComponent=!0;var At=["components"],Mt={toc:[]};function Lt(e){var t=e.components,a=(0,o.Z)(e,At);return(0,i.kt)("wrapper",(0,r.Z)({},Mt,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"function get_expiry(addr : address, permit_key : bytes) : nat {\n  return (permits[addr] ? let d = (the.user_expiry ? the : default_expiry) in\n    (the.user_permits[permit_key] ?\n      (the.expiry ? the : default_expiry) : d) :\n      default_expiry\n  )\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/function"},(0,i.kt)("inlineCode",{parentName:"a"},"function"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#bytes"},(0,i.kt)("inlineCode",{parentName:"a"},"bytes"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keya"},(0,i.kt)("inlineCode",{parentName:"a"},"[]"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/controls#a--b--c"},(0,i.kt)("inlineCode",{parentName:"a"},"?:"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/declaration"},(0,i.kt)("inlineCode",{parentName:"a"},"let"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/access#map"},(0,i.kt)("inlineCode",{parentName:"a"},"[]"))))}Lt.isMDXComponent=!0;var qt=["components"],Xt={toc:[]};function St(e){var t=e.components,a=(0,o.Z)(e,qt);return(0,i.kt)("wrapper",(0,r.Z)({},Xt,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"function has_expired(up : user_permit, e : nat) : bool {\n  return (up.created_at + (up.expiry ? the : e) * 1s < now)\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/function"},(0,i.kt)("inlineCode",{parentName:"a"},"function"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#bool"},(0,i.kt)("inlineCode",{parentName:"a"},"bool"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b"},(0,i.kt)("inlineCode",{parentName:"a"},"+"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/controls#a--b--c"},(0,i.kt)("inlineCode",{parentName:"a"},"?:"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-1"},(0,i.kt)("inlineCode",{parentName:"a"},"*"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/arithmetic#a--b-9"},(0,i.kt)("inlineCode",{parentName:"a"},"<"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#now"},(0,i.kt)("inlineCode",{parentName:"a"},"now"))))}St.isMDXComponent=!0;var Ft=["components"],Rt={toc:[]};function zt(e){var t=e.components,a=(0,o.Z)(e,Ft);return(0,i.kt)("wrapper",(0,r.Z)({},Rt,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"enum consumer_op =\n| add<address>\n| remove<address>\n\nentry manage_consumer(op : consumer_op) {\n  called by owner\n  effect {\n    match op with\n    | add(a)    -> consumer.add({ a })\n    | remove(a) -> consumer.remove(a)\n    end\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/language-basics/composite#enum"},(0,i.kt)("inlineCode",{parentName:"a"},"enum"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#called-by"},(0,i.kt)("inlineCode",{parentName:"a"},"called by"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#match-with"},(0,i.kt)("inlineCode",{parentName:"a"},"match"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aadda"},(0,i.kt)("inlineCode",{parentName:"a"},"add"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aremovek"},(0,i.kt)("inlineCode",{parentName:"a"},"remove"))))}zt.isMDXComponent=!0;var Ot=["components"],Ut={toc:[]};function Wt(e){var t=e.components,a=(0,o.Z)(e,Ot);return(0,i.kt)("wrapper",(0,r.Z)({},Ut,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry permit(signer : key, sig : signature, data : bytes) {\n  constant {\n    permit_key    is blake2b(data);\n    user          is key_to_address(signer);\n    usr_permit    is permits[user] ?\n                      (the.counter, the.user_permits) :\n                      (0, make_map<bytes, user_permit>([]));\n    lcounter      is usr_permit[0];\n    luser_permits is usr_permit[1];\n    to_sign       is pack(((self_address, self_chain_id), (lcounter, data)));\n    usr_expiry    is get_default_expiry(user);\n  }\n  require {\n    p4: is_not_paused();\n    p5: check_signature(signer, sig, to_sign) otherwise (MISSIGNED, to_sign)\n  }\n  effect {\n    permits.add_update(user, {\n      counter += 1;\n      user_permits = put(luser_permits, permit_key, {\n        expiry = some(usr_expiry);\n        created_at = now\n      })\n    });\n    for (k, v) in permits[user].user_permits do\n      if has_expired(v, usr_expiry)\n      then permits[user].user_permits.remove(k)\n    done\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#key"},(0,i.kt)("inlineCode",{parentName:"a"},"key"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#signature"},(0,i.kt)("inlineCode",{parentName:"a"},"signature"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#bytes"},(0,i.kt)("inlineCode",{parentName:"a"},"bytes"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#constant"},(0,i.kt)("inlineCode",{parentName:"a"},"constant"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#key_to_address(k%20:%20key)"},(0,i.kt)("inlineCode",{parentName:"a"},"key_to_address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keya"},(0,i.kt)("inlineCode",{parentName:"a"},"[]"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/controls#a--b--c"},(0,i.kt)("inlineCode",{parentName:"a"},"?:"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#make_map%3CK,%20V%3E(m)"},(0,i.kt)("inlineCode",{parentName:"a"},"make_map"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/access#ab"},(0,i.kt)("inlineCode",{parentName:"a"},"[]"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#pack(o%20:%20T)"},(0,i.kt)("inlineCode",{parentName:"a"},"pack"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#self_address"},(0,i.kt)("inlineCode",{parentName:"a"},"self_address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#self_chain_id"},(0,i.kt)("inlineCode",{parentName:"a"},"self_chain_id"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#check_signature(k%20:%20key,%20s%20:%20signature,%20b%20:%20bytes)"},(0,i.kt)("inlineCode",{parentName:"a"},"check_signature"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aadd_updatek--u-"},(0,i.kt)("inlineCode",{parentName:"a"},"add_update"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#put(m%20:%20map%3CK,%20V%3E,%20k%20:%20K,%20v%20:%20V)"},(0,i.kt)("inlineCode",{parentName:"a"},"put"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#some(v%20:%20T)"},(0,i.kt)("inlineCode",{parentName:"a"},"some"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#now"},(0,i.kt)("inlineCode",{parentName:"a"},"now"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#for"},(0,i.kt)("inlineCode",{parentName:"a"},"for"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#if"},(0,i.kt)("inlineCode",{parentName:"a"},"if"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/containers#mremovek"},(0,i.kt)("inlineCode",{parentName:"a"},"remove"))))}Wt.isMDXComponent=!0;var Bt=["components"],Vt={toc:[]};function Kt(e){var t=e.components,a=(0,o.Z)(e,Bt);return(0,i.kt)("wrapper",(0,r.Z)({},Vt,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry set_default_expiry(v : nat) {\n  called by owner\n  require { p3: is_not_paused() }\n  effect {\n    default_expiry := v\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#called-by"},(0,i.kt)("inlineCode",{parentName:"a"},"called by"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect")),"  ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/assignment#a--b"},(0,i.kt)("inlineCode",{parentName:"a"},":="))))}Kt.isMDXComponent=!0;var jt=["components"],Gt={toc:[]};function Yt(e){var t=e.components,a=(0,o.Z)(e,jt);return(0,i.kt)("wrapper",(0,r.Z)({},Gt,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry set_expiry(iv : option<nat>, ip : option<bytes>) {\n  constant {\n    caller_permit ?is permits[caller] otherwise (USER_PERMIT_NOT_FOUND, caller);\n  }\n  require {\n    r1: is_not_paused();\n    r2: iv ? the < default_expiry : true otherwise EXPIRY_TOO_BIG;\n  }\n  effect {\n    match ip with\n    | some(p) -> begin\n        const permit_key = blake2b(p);\n        if (iv ? the > 0 : true) then begin\n          const up : user_permit ?=\n            caller_permit.user_permits[permit_key] : (PERMIT_NOT_FOUND, (caller, p));\n          permits[caller].user_permits.update(permit_key, some({ up with expiry = iv }))\n        end else begin\n          permits[caller].user_permits.remove(permit_key)\n        end\n      end\n    | none    -> permits.update(caller, { user_expiry = iv })\n    end\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/localvariable#const"},(0,i.kt)("inlineCode",{parentName:"a"},"const"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/localvariable#"},(0,i.kt)("inlineCode",{parentName:"a"},"?="))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/asset#ak--asset_keya"},(0,i.kt)("inlineCode",{parentName:"a"},"[]"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#match-with"},(0,i.kt)("inlineCode",{parentName:"a"},"match"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/sequence"},(0,i.kt)("inlineCode",{parentName:"a"},"begin"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/control#if"},(0,i.kt)("inlineCode",{parentName:"a"},"if"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/controls#a--b--c"},(0,i.kt)("inlineCode",{parentName:"a"},"?:"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/expressions/operators/access#map"},(0,i.kt)("inlineCode",{parentName:"a"},"[]"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aupdatek--u-"},(0,i.kt)("inlineCode",{parentName:"a"},"update"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aremovek"},(0,i.kt)("inlineCode",{parentName:"a"},"remove"))))}Yt.isMDXComponent=!0;var Ht=["components"],$t={toc:[]};function Jt(e){var t=e.components,a=(0,o.Z)(e,Ht);return(0,i.kt)("wrapper",(0,r.Z)({},$t,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"record user_permit {\n  expiry : option<nat>;\n  created_at : date;\n}\n\nasset permits to big_map {\n  user_address : address;\n  counter      : nat = 0;\n  user_expiry  : option<nat> = none;\n  user_permits : map<bytes, user_permit> = [];\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#record"},(0,i.kt)("inlineCode",{parentName:"a"},"record"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#option%3CT%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"option"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#date"},(0,i.kt)("inlineCode",{parentName:"a"},"date"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/asset"},(0,i.kt)("inlineCode",{parentName:"a"},"asset"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,i.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#map%3CK,%20V%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"map"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#bytes"},(0,i.kt)("inlineCode",{parentName:"a"},"bytes"))))}Jt.isMDXComponent=!0;var Qt=["components"],ea={toc:[]};function ta(e){var t=e.components,a=(0,o.Z)(e,Qt);return(0,i.kt)("wrapper",(0,r.Z)({},ea,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"When dealing with ",(0,i.kt)("a",{parentName:"p",href:"/docs/templates/fa12"},"FA 1.2"),", the token_metadata map is initialized with the hex-encoded ipfs URI of the token metadata file (see ",(0,i.kt)("a",{parentName:"p",href:"/docs/templates/tokenmetadata#examples"},"examples")," below):"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"TOKEN_ID")," is the the constant ",(0,i.kt)("inlineCode",{parentName:"li"},"0")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"metadata_coin")," is a contract ",(0,i.kt)("a",{parentName:"li",href:"/docs/reference/declarations/contract#constant"},"constant parameter"),".")),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)(I.Z,{defaultValue:"FA 1.2",mdxType:"Tabs"},(0,i.kt)(P.Z,{value:"FA 1.2",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},'constant TOKEN_ID : nat = 0\n\nasset token_metadata to big_map {\n  ftoken_metadata : nat;\n  token_id        : nat;\n  token_info      : map<string, bytes>;\n} initialized with {\n  {TOKEN_ID; TOKEN_ID; [("", metadata_coin)]}\n}\n'))),(0,i.kt)(P.Z,{value:"FA 2",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"asset token_metadata to big_map {\n  ftoken_metadata : nat;\n  token_id        : nat;\n  token_info      : map<string, bytes>;\n}\n")))),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/asset"},(0,i.kt)("inlineCode",{parentName:"a"},"asset"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#map%3CK,%20V%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"map"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#string"},(0,i.kt)("inlineCode",{parentName:"a"},"string"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#bytes"},(0,i.kt)("inlineCode",{parentName:"a"},"bytes"))))}ta.isMDXComponent=!0;var aa=["components"],na={toc:[]};function ra(e){var t=e.components,a=(0,o.Z)(e,aa);return(0,i.kt)("wrapper",(0,r.Z)({},na,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(l.Z,{title:"Code",width:"1.5",mdxType:"NamedDivider"}),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-archetype"},"entry set_token_metadata (tid : nat, tdata: map<string, bytes>) {\n  called by owner\n  require { tmd_r1: is_not_paused() }\n  effect {\n    token_metadata.add_update(itokenid, { tid = tid; token_info = tdata });\n  }\n}\n")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,i.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#nat"},(0,i.kt)("inlineCode",{parentName:"a"},"nat"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#map%3CK,%20V%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"map"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#string"},(0,i.kt)("inlineCode",{parentName:"a"},"string"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/types#map%3CK,%20V%3E"},(0,i.kt)("inlineCode",{parentName:"a"},"bytes"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#called-by"},(0,i.kt)("inlineCode",{parentName:"a"},"called by"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,i.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/templates/pausable#is_not_paused"},(0,i.kt)("inlineCode",{parentName:"a"},"is_not_paused"))," ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,i.kt)("inlineCode",{parentName:"a"},"effect")),"  ",(0,i.kt)("a",{parentName:"p",href:"/docs/reference/instructions/asset#aadd_updatek--u-"},(0,i.kt)("inlineCode",{parentName:"a"},"add_update"))))}ra.isMDXComponent=!0;var oa="/docs/templates/",sa={tzips:[{label:"FA 1.2",link:oa+"fa12",desc:s.createElement("div",null,"Implements ",s.createElement(n.Z,{to:"https://tzip.tezosagora.org/proposal/tzip-7/"},"TZIP-7")," norm for fungible Token")},{label:"FA 2",link:oa+"fa2",desc:s.createElement("div",null,"Implements ",s.createElement(n.Z,{to:"https://tzip.tezosagora.org/proposal/tzip-12/"},"TZIP-12")," norm for tokens (Non Fungible, Fungible, Multi)")},{label:"A 2",link:oa+"a2",desc:s.createElement("div",null,"Implements ",s.createElement(n.Z,{to:"https://tzip.tezosagora.org/proposal/tzip-15/"},"TZIP-15")," norm for whitelisting process")},{label:"Metadata",link:oa+"metadata",desc:s.createElement("div",null,"Implements ",s.createElement(n.Z,{to:"https://tzip.tezosagora.org/proposal/tzip-16/"},"TZIP-16")," norm for contract's metadata")},{label:"Permits",link:oa+"permits",desc:s.createElement("div",null,"Implements ",s.createElement(n.Z,{to:"https://tzip.tezosagora.org/proposal/tzip-17/"},"TZIP-17")," norm for feeless operations")},{label:"Token metadata",link:oa+"tokenmetadata",desc:s.createElement("div",null,"Implements ",s.createElement(n.Z,{to:"https://tzip.tezosagora.org/proposal/tzip-17/"},"TZIP-21")," norm for token metadata")}],others:[{label:"MultiSig",link:oa+"multisig",desc:"Execute operations signed by a required number of managers"},{label:"Pausable",link:oa+"pausable",desc:"Pausable entrypoints"},{label:"Ownership",link:oa+"ownership",desc:"Transferrable contract owner"}],fa12:{info:{repo:"https://github.com/completium/archetype-fa1",author:"Completium",authorurl:"https://completium.com/",norms:[{label:"TZIP-4",url:"https://tzip.tezosagora.org/proposal/tzip-4/"},{label:"TZIP-7",url:"https://tzip.tezosagora.org/proposal/tzip-7/"},{label:"TZIP-21",url:"https://tzip.tezosagora.org/proposal/tzip-21/"}]},transfer:{desc:s.createElement(D,null),sig:"transfer(from, to, value)",parameters:[{type:"address",alias:"from",desc:s.createElement("div",null,"Sending tokens address")},{type:"address",alias:"to",desc:s.createElement("div",null,"Receiving tokens address")},{type:"nat",alias:"value",desc:s.createElement("div",null,"Number of tokens to transfer")}],fails:[{keyword:'("ASSET_NOT_FOUND", "ledger")',desc:s.createElement("div",null,"When address ",s.createElement("code",null,"from")," is not found in ",s.createElement(n.Z,{to:"/docs/templates/fa12#ledger"},s.createElement("code",null,"ledger")))},{keyword:"NotEnoughBalance",desc:s.createElement("div",null,"When number of tokens owned by ",s.createElement("code",null,"from")," is less than ",s.createElement("code",null,"value"))},{keyword:'("ASSET_NOT_FOUND", "allowance")',desc:s.createElement("div",null,"When ",s.createElement("code",null,"caller")," is not allowed by ",s.createElement("code",null,"from")," to transfer tokens")},{keyword:"NotEnoughAllowance",desc:s.createElement("div",null,"When ",s.createElement("code",null,"caller"),"'s allowed transfer is less than ",s.createElement("code",null,"value"))}],related:[{keyword:"transfer",link:"/docs/reference/instructions/operation#transfer"},{keyword:"ledger",link:"/docs/templates/fa12#ledger"},{keyword:"allowance",link:"/docs/templates/fa12#allowance"}]},approve:{desc:s.createElement(f,null),sig:"approve",parameters:[{type:"address",alias:"spender",desc:s.createElement("div",null,"Approved address to transfer tokens from ",s.createElement(n.Z,{to:"/docs/reference/expressions/constants#caller"},s.createElement("code",null,"caller")))},{type:"nat",alias:"value",desc:s.createElement("div",null,"Number of tokens approved for transfer")}],fails:[{keyword:'("UnsafeAllowanceChange", previous)',desc:s.createElement("div",null,"When ",s.createElement("code",null,"spender")," is already approved a non-zero amount of tokens (",s.createElement("code",null,"previous"),")")}],related:[{keyword:"allowance",link:"/docs/templates/fa12#allowance"}]},getallowance:{desc:s.createElement(y,null),sig:"getallowance",parameters:[{type:"address",alias:"owner",desc:s.createElement("div",null,"Tokens owner")},{type:"address",alias:"spender",desc:s.createElement("div",null,"Approved address to transfer tokens from ",s.createElement("code",null,"owner"))}],returns:{type:"nat",desc:s.createElement("div",null,"Number of tokens ",s.createElement("code",null,"spender")," can transfer on behalf of ",s.createElement("code",null,"owner"))}},getbalance:{desc:s.createElement(C,null),sig:"getbalance",parameters:[{type:"address",alias:"owner",desc:s.createElement("div",null,"Tokens owner")}],returns:{type:"nat",desc:s.createElement("div",null,"Number of tokens owned by ",s.createElement("code",null,"owner"))}},gettotalsupply:{desc:s.createElement(b,null),sig:"gettotalsupply",returns:{type:"nat",desc:s.createElement("div",null,"Value of ",s.createElement(n.Z,{to:"/docs/templates/fa12#total_supply"},s.createElement("code",null,"total_supply")))}},initialholder:{desc:s.createElement("div",null,"Initial owner of the total supply of tokens"),type:"address",related:[{keyword:"total_supply",link:"/docs/templates/fa12#total_supply"}]},totalsupply:{desc:s.createElement("div",null,"Total number of tokens. Note that this value is a constant since there is no ",s.createElement("i",null,"mint")," or ",s.createElement("i",null,"burn")," mechanism in this version."),type:"nat",related:[{keyword:"getTotalSupply",link:"/docs/templates/fa12#gettotalsupply"}]},ledger:{desc:s.createElement(x,null),type:"big_map<address, nat>",typeUrl:"big_map<K,%20V>",related:[{keyword:"transfer",link:"/docs/templates/fa12#transferfrom-to-value"}]},allowance:{desc:s.createElement(c,null),type:"big_map<address * address, nat>",typeUrl:"big_map<K,%20V>",related:[{keyword:"transfer",link:"/docs/templates/fa12#transferfrom-to-value"},{keyword:"approve",link:"/docs/templates/fa12#approvespender-value"}]}},fa2:{info:{repo:"https://github.com/completium/archetype-fa2",author:"Completium",authorurl:"https://completium.com/",norms:[{label:"TZIP-4",url:"https://tzip.tezosagora.org/proposal/tzip-4/"},{label:"TZIP-12",url:"https://tzip.tezosagora.org/proposal/tzip-12/"},{label:"TZIP-16",url:"https://tzip.tezosagora.org/proposal/tzip-16/"},{label:"TZIP-17",url:"https://tzip.tezosagora.org/proposal/tzip-17/"},{label:"TZIP-21",url:"https://tzip.tezosagora.org/proposal/tzip-21/"}],templates:[{label:"Pausable",url:"/docs/templates/pausable"},{label:"Ownership",url:"/docs/templates/ownership"},{label:"Metadata",url:"/docs/templates/metadata"},{label:"Permits",url:"/docs/templates/permits"},{label:"Token metadata",url:"/docs/templates/tokenmetadata"}]},transfer_arg:{desc:s.createElement(Pe,null),type:"record",michelson:"pair",michelson_ref_url:"https://tezos.gitlab.io/michelson-reference/#instr-PAIR",related:[{keyword:"check_operator",link:"/docs/templates/fa2#check_operatortxs"},{keyword:"get_from",link:"/docs/templates/fa2#get_fromtxs"},{keyword:"do_transfer",link:"/docs/templates/fa2#do_transfertxs"},{keyword:"transfer_gasless",link:"/docs/templates/fa2#transfer_gaslessbatch"}]},ledger:{desc:s.createElement(de,null),type:"big_map<nat, address>",typeUrl:"big_map<K,%20V>",related:[{keyword:"transfer",link:"/docs/templates/fa12#transferfrom-to-value"}]},ledger_fungible:{desc:s.createElement(re,null),type:"big_map<address, nat>",typeUrl:"big_map<K,%20V>",related:[{keyword:"transfer",link:"/docs/templates/fa12#transferfrom-to-value"}]},ledger_multi:{desc:s.createElement(ie,null),type:"big_map<address * nat, nat>",typeUrl:"big_map<K,%20V>",related:[{keyword:"transfer",link:"/docs/templates/fa12#transferfrom-to-value"}]},royalties:{desc:s.createElement(Te,null),type:"big_map<nat, list<part>>",typeUrl:"big_map<K,%20V>",related:[{keyword:"transfer",link:"/docs/templates/fa12#transferfrom-to-value"}]},operators:{desc:s.createElement(we,null),type:"big_map<address * nat * address, unit>",typeUrl:"big_map<K,%20V>",related:[{keyword:"transfer",link:"/docs/templates/fa12#transferfrom-to-value"}]},operator_for_all:{desc:s.createElement(ge,null),type:"big_map<address * address, unit>",typeUrl:"big_map<K,%20V>",related:[{keyword:"transfer",link:"/docs/templates/fa12#transferfrom-to-value"}]},update_operators:{desc:s.createElement(We,null),sig:"update_operators",parameters:[{type:"list<update_op>",typeUrl:"list<T>",alias:"upl",desc:s.createElement("div",null,"List of operators to add or remove.")}],fails:[{keyword:'"CONTRACT_PAUSED"',desc:s.createElement("div",null,"When contract is already paused.")},{keyword:'"CALLER_NOT_OWNER"',desc:s.createElement("div",null,"When specified token owner is not ",s.createElement("code",null,"caller"),".")}],related:[{keyword:"is_not_paused",link:"/docs/templates/pausable#is_not_paused"}]},update_operator_forall:{desc:s.createElement(ze,null),sig:"update_operator_for_all",parameters:[{type:"list<update_for_all_op>",typeUrl:"list<T>",alias:"upl",desc:s.createElement("div",null,"List of operators to add or remove.")}],fails:[{keyword:'"CONTRACT_PAUSED"',desc:s.createElement("div",null,"When contract is already paused.")}],related:[{keyword:"is_not_paused",link:"/docs/templates/pausable#is_not_paused"}]},do_transfer:{desc:s.createElement(Y,null),sig:"",parameters:[{type:"list<transfer_param>",typeUrl:"list<T>",alias:"txs",desc:s.createElement("div",null,"List of pairs of sender address and transfer destination.")}],fails:[{keyword:'"INVALID_CALLER"',desc:s.createElement("div",null,"When caller is not current contract.")},{keyword:'"FA2_TOKEN_UNDEFINED"',desc:s.createElement("div",null,"When specified token id is not found in ",s.createElement("code",null,"ledger"),".")},{keyword:'"FA2_INSUFFICIENT_BALANCE"',desc:s.createElement("div",null,"When specified token owner is not the one found in ",s.createElement("code",null,"ledger"),".")}],related:[{keyword:"transfer",link:"/docs/templates/fa2#transfertxs-"},{keyword:"transfer_gasless",link:"/docs/templates/fa2#transfer_gaslessbatch"}]},transfer_gasless:{desc:s.createElement(Le,null),sig:"",parameters:[{type:"list<gasless_param>",typeUrl:"list<T>",alias:"batch",desc:s.createElement("div",null,"List of pairs of permits (key and signature) and transfer specification.")}],fails:[{keyword:'"CONTRACT_PAUSED"',desc:s.createElement("div",null,"When contract is already paused.")}],related:[{keyword:"do_transfer",link:"/docs/templates/fa2#do_transfertxs"},{keyword:"check",link:"/docs/templates/permits#checksigner-sig-data"},{keyword:"is_not_paused",link:"/docs/templates/pausable#is_not_paused"}]},transfer:{desc:s.createElement(Se,null),sig:"",parameters:[{type:"list<transfer_param>",typeUrl:"list<T>",alias:"txs",desc:s.createElement("div",null,"List of pairs of sender address and transfer destination.")}],fails:[{keyword:'"CONTRACT_PAUSED"',desc:s.createElement("div",null,"When contract is already paused.")},{keyword:'"FA2_NOT_OPERATOR"',desc:s.createElement("div",null,"When caller is not the owner, nor a declared operator, or when specified from has no permit")}],related:[{keyword:"consume",link:"/docs/templates/permits#consumefrom-data-err"},{keyword:"do_transfer",link:"/docs/templates/fa2#do_transfertxs"}]},get_from_address:{desc:s.createElement(J,null),sig:"",parameters:[{type:"list<transfer_param>",typeUrl:"list<T>",alias:"txs",desc:s.createElement("div",null,"List of pairs of sender address and transfer destination.")}],fails:[],returns:{type:"option<address>",desc:""},related:[]},check_owner_and_operator:{desc:s.createElement(K,null),sig:"",parameters:[{type:"list<transfer_param>",typeUrl:"list<T>",alias:"txs",desc:s.createElement("div",null,"List of pairs of sender address and transfer destination.")}],fails:[],returns:{type:"bool",desc:""},related:[]},mint:{desc:s.createElement(_e,null),sig:"",parameters:[{type:"address",alias:"tow",desc:s.createElement("div",null,"Token owner.")},{type:"nat",alias:"tid",desc:s.createElement("div",null,"Token identifier.")},{type:"map<string, bytes>",typeUrl:"map<K,%20V>",alias:"tmd",desc:s.createElement("div",null,"Token metadata.")},{type:"list<part>",typeUrl:"list<T>",alias:"roy",desc:s.createElement("div",null,"Token royalties.")}],fails:[{keyword:'"CONTRACT_PAUSED"',desc:s.createElement("div",null,"When contract is already paused.")},{keyword:'("ledger", "KEY_EXISTS")',desc:s.createElement("div",null,"When token already exists in ",s.createElement("code",null,"ledger"),".")}],related:[{keyword:"is_not_paused",link:"/docs/templates/pausable#is_not_paused"},{keyword:"token_metadata",link:"/docs/templates/tokenmetadata#token_metadata"}]},mint_fungible:{desc:s.createElement(ue,null),sig:"",parameters:[{type:"address",alias:"tow",desc:s.createElement("div",null,"Token owner to receive minted tokens")},{type:"nat",alias:"nbt",desc:s.createElement("div",null,"Number of tokens to mint")}],fails:[{keyword:'"CONTRACT_PAUSED"',desc:s.createElement("div",null,"When contract is already paused.")},{keyword:'("ledger", "KEY_EXISTS")',desc:s.createElement("div",null,"When token already exists in ",s.createElement("code",null,"ledger"),".")}],related:[{keyword:"is_not_paused",link:"/docs/templates/pausable#is_not_paused"}]},mint_multi:{desc:s.createElement(Ne,null),sig:"",parameters:[{type:"address",alias:"tow",desc:s.createElement("div",null,"Token owner to receive minted tokens")},{type:"nat",alias:"tid",desc:s.createElement("div",null,"Token identifier to mint")},{type:"nat",alias:"nbt",desc:s.createElement("div",null,"Number of tokens to mint")}],fails:[{keyword:'"CONTRACT_PAUSED"',desc:s.createElement("div",null,"When contract is already paused.")},{keyword:'("ledger", "KEY_EXISTS")',desc:s.createElement("div",null,"When token already exists in ",s.createElement("code",null,"ledger"),".")}],related:[{keyword:"is_not_paused",link:"/docs/templates/pausable#is_not_paused"}]},burn:{desc:s.createElement(W,null),sig:"",parameters:[{type:"nat",alias:"tid",desc:s.createElement("div",null,"Token identifier.")}],fails:[{keyword:'"FA2_TOKEN_UNDEFINED"',desc:s.createElement("div",null,"When ",s.createElement("code",null,"tid")," is not found in ",s.createElement("code",null,"ledger"),".")},{keyword:'"CALLER_NOT_OWNER"',desc:s.createElement("div",null,"When ",s.createElement("code",null,"tid"),"'s owner is not ",s.createElement("code",null,"caller"),".")}],related:[]},burn_fungible:{desc:s.createElement(S,null),sig:"",parameters:[{type:"nat",alias:"nbt",desc:s.createElement("div",null,"Number of tokens to burn")}],fails:[{keyword:'"FA2_INSUFFICIENT_BALANCE"',desc:s.createElement("div",null,"When ",s.createElement("code",null,"nbt")," is greater than the number of tokens owned by ",s.createElement("code",null,"caller"),".")}],related:[]},burn_multi:{desc:s.createElement(z,null),sig:"",parameters:[{type:"nat",alias:"tid",desc:s.createElement("div",null,"Token identifier")},{type:"nat",alias:"nbt",desc:s.createElement("div",null,"Number of tokens to burn")}],fails:[{keyword:'"FA2_INSUFFICIENT_BALANCE"',desc:s.createElement("div",null,"When ",s.createElement("code",null,"nbt")," is greater than the number of tokens owned by ",s.createElement("code",null,"caller"),".")}],related:[]},balance_of:{desc:s.createElement(L,null),parameters:[{type:"list<balance_of_param>",alias:"requests",desc:s.createElement("div",null,"List of pairs of owner and token id to get balance of.")}],fails:[],related:[{keyword:"getter",link:"/docs/reference/declarations/entrypoint#getter"}]},get_royalties:{desc:s.createElement(te,null),parameters:[{type:"nat",alias:"tokenid",desc:s.createElement("div",null,"Token identifier.")}],returns:{type:"list<part>",desc:s.createElement("div",null,"List of pairs of address and percentage")},related:[{keyword:"royalties",link:"/docs/templates/fa2#royalties"}]}},a2:{info:{repo:"https://gitlab.com/tezos-paris-hub/whitelist-smart-contract-archetype",author:"Completium",authorurl:"https://completium.com/",norms:[{label:"TZIP-15",url:"https://tzip.tezosagora.org/proposal/tzip-15/"},{label:"TZIP-16",url:"https://tzip.tezosagora.org/proposal/tzip-16/"}]}},multisig:{info:{repo:"https://github.com/completium/archetype-multisig",author:"Completium",authorurl:"https://completium.com/",norms:[{label:"TZIP-16",url:"https://tzip.tezosagora.org/proposal/tzip-16/"}]}},ownership:{info:{repo:"https://github.com/completium/archetype-ownership",author:"Completium",authorurl:"https://completium.com/"},owner:{desc:s.createElement(rt,null),type:"address",related:[{keyword:"owner_candidate",link:"/docs/templates/ownership#owner_candidate"}]},candidate:{desc:s.createElement(Ye,null),type:"option<address>",typeUrl:"option<T>",related:[{keyword:"owner",link:"/docs/templates/ownership#owner"}]},declare:{desc:s.createElement(tt,null),sig:"declare_ownership(candidate)",parameters:[{type:"address",alias:"candidate",desc:s.createElement("div",null,"Candidate address for next contract's owner")}],fails:[{keyword:'"INVALID_CALLER"',desc:s.createElement("div",null,"When ",s.createElement("code",null,"caller")," is not ",s.createElement("code",null,"owner"))}],related:[{keyword:"owner_candidate",link:"/docs/templates/ownership#owner_candidate"}]},claim:{desc:s.createElement(Je,null),sig:"claim_ownership()",parameters:[],fails:[{keyword:'"INVALID_CALLER"',desc:s.createElement("div",null,"When ",s.createElement("code",null,"caller")," is not ",s.createElement("code",null,"owner_candidate"))}],related:[{keyword:"owner_candidate",link:"/docs/templates/ownership#owner_candidate"}]}},pausable:{info:{repo:"https://github.com/completium/archetype-pausable",author:"Completium",authorurl:"https://completium.com/",templates:[{label:"Ownership",url:"/docs/templates/ownership"}]},paused:{desc:s.createElement(ut,null),type:"bool",related:[{keyword:"is_not_paused",link:"/docs/templates/pausable#is_not_paused"},{keyword:"pause",link:"/docs/templates/pausable#pause"},{keyword:"unpause",link:"/docs/templates/pausable#unpause"}]},pause:{desc:s.createElement(dt,null),sig:"pause()",parameters:[],fails:[{keyword:'"INVALID_CALLER"',desc:s.createElement("div",null,"When ",s.createElement("code",null,"caller")," is not ",s.createElement("code",null,"owner"))},{keyword:'"CONTRACT_PAUSED"',desc:s.createElement("div",null,"When contract is already paused.")}],related:[{keyword:"unpause",link:"/docs/templates/pausable#unpause"}]},unpause:{desc:s.createElement(Nt,null),sig:"unpause()",parameters:[],fails:[{keyword:'"INVALID_CALLER"',desc:s.createElement("div",null,"When ",s.createElement("code",null,"caller")," is not ",s.createElement("code",null,"owner"))},{keyword:'"CONTRACT_NOT_PAUSED"',desc:s.createElement("div",null,"When contract is not paused.")}],related:[{keyword:"paused",link:"/docs/templates/pausable#paused"}]},is_not_paused:{desc:s.createElement(it,null),sig:"is_not_paused()",parameters:[],fails:[{keyword:'"CONTRACT_PAUSED"',desc:s.createElement("div",null,"When contract is already paused.")}],returns:{type:"bool",desc:s.createElement("div",null,s.createElement("code",null,"true")," if contract is not paused")},related:[{keyword:"paused",link:"/docs/templates/pausable#paused"}]}},metadata:{info:{repo:"https://github.com/completium/archetype-metadata",author:"Completium",authorurl:"https://completium.com/",norms:[{label:"TZIP-16",link:"https://tzip.tezosagora.org/proposal/tzip-16/"}],templates:[{label:"Ownership",url:"/docs/templates/ownership"},{label:"Pausable",url:"/docs/templates/pausable"}]},set_metadata:{desc:s.createElement(Ke,null),sig:"set_metadata(k, v)",parameters:[{type:"string",alias:"k",desc:s.createElement("div",null,"Medata entry name")},{type:"option<bytes>",withLink:!1,alias:"v",desc:s.createElement("div",null,"Medata value option:",s.createElement("ul",null,s.createElement("li",null,s.createElement("code",null,"some(v)")," associates ",s.createElement("code",null,"v")," to ",s.createElement("code",null,"k")),s.createElement("li",null,s.createElement("code",null,"none")," removes entry ",s.createElement("code",null,"k"))))}],fails:[{keyword:'"INVALID_CALLER"',desc:s.createElement("div",null,"When ",s.createElement("code",null,"caller")," is not ",s.createElement("code",null,"owner"))},{keyword:'"CONTRACT_PAUSED"',desc:s.createElement("div",null,"When contract is already paused.")}],related:[{keyword:"Archetype contract",link:"/docs/reference/declarations/contract#metadata"}]}},permits:{info:{repo:"https://github.com/completium/archetype-permits",author:"Completium",authorurl:"https://completium.com/",norms:[{label:"TZIP-16",url:"https://tzip.tezosagora.org/proposal/tzip-16/"}],templates:[{label:"Metadata",url:"/docs/templates/metadata"},{label:"Pausable",url:"/docs/templates/pausable"},{label:"Ownership",url:"/docs/templates/ownership"}]},consumer:{desc:s.createElement(wt,null),type:"set<address>",typeUrl:"set<T>",related:[{keyword:"manage_consumer",link:"/docs/templates/permits#manage_consumer(op)"}]},permits:{desc:s.createElement(Jt,null),type:"big_map<asset_key<permits>, asset_value<permits>",typeUrl:"big_map<K,%20V>",related:[{keyword:"asset_key",link:"/docs/reference/types#asset_key<A>"},{keyword:"asset_value",link:"/docs/reference/types#asset_value<A>"}]},default_expiry:{desc:s.createElement(Tt,null),type:"duration",related:[{keyword:"Variable",link:"/docs/reference/declarations/storage#variable"}]},get_default_expiry:{desc:s.createElement(Pt,null),parameters:[{type:"address",alias:"addr",desc:s.createElement("div",null,"Address to get expiry of")}],fails:[],returns:{type:"nat",desc:s.createElement("div",null,s.createElement("code",null,"addr"),"'s expiry or default expiry if not found ")},related:[{keyword:"paused",link:"/docs/templates/pausable#paused"}]},get_expiry:{desc:s.createElement(Lt,null),parameters:[{type:"address",alias:"addr",desc:s.createElement("div",null,"Address to get expiry of")},{type:"bytes",alias:"permit_key",desc:s.createElement("div",null,"Permit key")}],fails:[],returns:{type:"nat",desc:s.createElement("div",null,s.createElement("code",null,"addr"),"'s permit ",s.createElement("code",null,"permit_key")," expiry or default expiry if not found ")},related:[{keyword:"default_expiry",link:"/docs/templates/permits#default_expiry"},{keyword:"permits",link:"/docs/templates/permits#permits-1"}]},has_expired:{desc:s.createElement(St,null),parameters:[{type:"user_permit",alias:"up",desc:s.createElement("div",null,"User permit")},{type:"nat",alias:"e",desc:s.createElement("div",null,"Expiry")}],fails:[],returns:{type:"bool",desc:s.createElement("div",null)},related:[{keyword:"permits",link:"/docs/templates/permits#permits-1"}]},set_expiry:{desc:s.createElement(Yt,null),parameters:[{type:"option<nat>",alias:"v",desc:s.createElement("div",null,"User permit")},{type:"option<bytes>",alias:"p",desc:s.createElement("div",null,"Expiry")}],fails:[{keyword:'"CONTRACT_PAUSED"',desc:s.createElement("div",null,"When contract is paused.")},{keyword:'"EXPIRY_TOO_BIG"',desc:s.createElement("div",null,"When ",s.createElement("code",null,"iv")," is some value greater the ",s.createElement("code",null,"default_expiry"),".")},{keyword:'("USER_PERMIT_NOT_FOUND", caller)',desc:s.createElement("div",null,"When ",s.createElement("code",null,"caller")," is not found in ",s.createElement("code",null,"permits"),".")},{keyword:'("PERMIT_NOT_FOUND", (caller, p))',desc:s.createElement("div",null,"When ",s.createElement("code",null,"ip")," is some value of a permit key not found in ",s.createElement("code",null,"caller"),"'s permits.")}],related:[{keyword:"is_not_paused",link:"/docs/templates/pausable#is_not_paused"},{keyword:"permits",link:"/docs/templates/permits#permits-1"},{keyword:"default_expiry",link:"/docs/templates/permits#default_expiry"}]},set_default_expiry:{desc:s.createElement(Kt,null),parameters:[{type:"nat",alias:"v",desc:s.createElement("div",null,"New default expiry value")}],fails:[{keyword:'"INVALID_CALLER"',desc:s.createElement("div",null,"When ",s.createElement("code",null,"caller")," is not ",s.createElement("code",null,"owner"))},{keyword:'"CONTRACT_PAUSED"',desc:s.createElement("div",null,"When contract is paused.")}],related:[{keyword:"default_expiry",link:"/docs/templates/permits#default_expiry"},{keyword:"is_not_paused",link:"/docs/templates/pausable#is_not_paused"}]},permit:{desc:s.createElement(Wt,null),parameters:[{type:"key",alias:"pk",desc:s.createElement("div",null,"Public key that signed ",s.createElement("code",null,"data"))},{type:"signature",alias:"sig",desc:s.createElement("div",null,"Signed ",s.createElement("code",null,"data")," by ",s.createElement("code",null,"pk"),".")},{type:"bytes",alias:"data",desc:s.createElement("div",null,"Permit data.")}],fails:[{keyword:'"CONTRACT_PAUSED"',desc:s.createElement("div",null,"When contract is paused.")},{keyword:'("MISSIGNED", to_sign)',desc:s.createElement("div",null,"When ",s.createElement("code",null,"sign")," is not obtained from ",s.createElement("code",null,"data"),".")}],related:[{keyword:"permits",link:"/docs/templates/permits#permits-1"},{keyword:"get_default_expiry",link:"/docs/templates/permits#get_default_expiryaddr"},{keyword:"has_expired",link:"/docs/templates/permits#has_expireduserp-expiry"}]},consume_permit:{desc:s.createElement(gt,null),parameters:[{type:"address",alias:"%from",desc:s.createElement("div",null,"Public key that signed ",s.createElement("code",null,"data"))},{type:"signature",alias:"sig",desc:s.createElement("div",null,"Signed ",s.createElement("code",null,"data")," by ",s.createElement("code",null,"pk"),".")},{type:"bytes",alias:"data",desc:s.createElement("div",null,"Permit data.")}],fails:[{keyword:'"INVALID_CALLER"',desc:s.createElement("div",null,"When ",s.createElement("code",null,"caller")," is not a ",s.createElement("code",null,"consumer"),".")},{keyword:'"CONTRACT_PAUSED"',desc:s.createElement("div",null,"When contract is paused.")},{keyword:'"USER_PERMIT_NOT_FOUND"',desc:s.createElement("div",null,"When ",s.createElement("code",null,"signer")," is not found in ",s.createElement("code",null,"permits"),".")},{keyword:'"PERMIT_EXPIRED"',desc:s.createElement("div",null,"When ",s.createElement("code",null,"signer"),"'s permit has expired.")}],related:[{keyword:"permits",link:"/docs/templates/permits#permits-1"},{keyword:"get_expiry",link:"/docs/templates/permits#get_expiryaddr-permitkey"},{keyword:"has_expired",link:"/docs/templates/permits#has_expireduserp-expiry"}]},check_permit:{desc:s.createElement(_t,null),parameters:[{type:"address",alias:"%from",desc:s.createElement("div",null,"Public key that signed ",s.createElement("code",null,"data"))},{type:"signature",alias:"sig",desc:s.createElement("div",null,"Signed ",s.createElement("code",null,"data")," by ",s.createElement("code",null,"pk"),".")},{type:"bytes",alias:"data",desc:s.createElement("div",null,"Permit data.")}],fails:[{keyword:'"INVALID_CALLER"',desc:s.createElement("div",null,"When ",s.createElement("code",null,"caller")," is not a ",s.createElement("code",null,"consumer"))},{keyword:'"CONTRACT_PAUSED"',desc:s.createElement("div",null,"When contract is paused.")},{keyword:'("MISSIGNED", to_sign)',desc:s.createElement("div",null,"When ",s.createElement("code",null,"sign")," is not obtained from ",s.createElement("code",null,"data"),".")}],related:[{keyword:"consumer",link:"/docs/templates/permits#consumer"},{keyword:"permits",link:"/docs/templates/permits#permits-1"}]},manage_consumer:{desc:s.createElement(zt,null),parameters:[{type:"consumer_op",alias:"op",desc:s.createElement("div",null,"Consumer operation specification:",s.createElement("ul",null,s.createElement("li",null,s.createElement("code",null,"add(a)")," to add consumer ",s.createElement("code",null,"a")),s.createElement("li",null,s.createElement("code",null,"remove(a)")," to remove consumer ",s.createElement("code",null,"a"))))}],related:[{keyword:"consumer",link:"/docs/templates/permits#consumer"}]}},token_metadata:{info:{repo:"https://github.com/completium/archetype-token-metadata",author:"Completium",authorurl:"https://completium.com/",templates:[{label:"Pausable",url:"/docs/templates/pausable"},{label:"Ownership",url:"/docs/templates/ownership"}]},token_metadata:{desc:s.createElement(ta,null),type:"big_map<asset_key<token_metadata>, asset_value<token_metadata>",typeUrl:"big_map<K,%20V>",related:[{keyword:"asset_key",link:"/docs/reference/types#asset_key<A>"},{keyword:"asset_value",link:"/docs/reference/types#asset_value<A>"}]},set_token_metadata:{desc:s.createElement(ra,null),sig:"set_token_metadata",parameters:[{type:"nat",alias:"tid",desc:s.createElement("div",null,"Token id")},{type:"map<string, bytes>",alias:"tdata",desc:s.createElement("div",null,"Token data")}],fails:[{keyword:'"INVALID_CALLER"',desc:s.createElement("div",null,"When ",s.createElement("code",null,"caller")," is not ",s.createElement("code",null,"owner"))},{keyword:'"CONTRACT_PAUSED"',desc:s.createElement("div",null,"When contract is paused.")}],related:[{keyword:"Asset",link:"/docs/asset"}]}}}},5162:function(e,t,a){a.d(t,{Z:function(){return s}});var n=a(7294),r=a(6010),o="tabItem_Ymn6";function s(e){var t=e.children,a=e.hidden,s=e.className;return n.createElement("div",{role:"tabpanel",className:(0,r.Z)(o,s),hidden:a},t)}},5488:function(e,t,a){a.d(t,{Z:function(){return u}});var n=a(7462),r=a(7294),o=a(6010),s=a(2389),i=a(7392),l=a(7094),p=a(2466),d="tabList__CuJ",c="tabItem_LNqP";function m(e){var t,a,s=e.lazy,m=e.block,u=e.defaultValue,f=e.values,k=e.groupId,N=e.className,y=r.Children.map(e.children,(function(e){if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),h=null!=f?f:y.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),_=(0,i.l)(h,(function(e,t){return e.value===t.value}));if(_.length>0)throw new Error('Docusaurus error: Duplicate values "'+_.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var C=null===u?u:null!=(t=null!=u?u:null==(a=y.find((function(e){return e.props.default})))?void 0:a.props.value)?t:y[0].props.value;if(null!==C&&!h.some((function(e){return e.value===C})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+C+'" but none of its children has the corresponding value. Available values are: '+h.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var v=(0,l.U)(),g=v.tabGroupChoices,b=v.setTabGroupChoices,E=(0,r.useState)(C),w=E[0],x=E[1],Z=[],T=(0,p.o5)().blockElementScrollPositionUntilNextRender;if(null!=k){var D=g[k];null!=D&&D!==w&&h.some((function(e){return e.value===D}))&&x(D)}var I=function(e){var t=e.currentTarget,a=Z.indexOf(t),n=h[a].value;n!==w&&(T(t),x(n),null!=k&&b(k,String(n)))},P=function(e){var t,a=null;switch(e.key){case"ArrowRight":var n,r=Z.indexOf(e.currentTarget)+1;a=null!=(n=Z[r])?n:Z[0];break;case"ArrowLeft":var o,s=Z.indexOf(e.currentTarget)-1;a=null!=(o=Z[s])?o:Z[Z.length-1]}null==(t=a)||t.focus()};return r.createElement("div",{className:(0,o.Z)("tabs-container",d)},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":m},N)},h.map((function(e){var t=e.value,a=e.label,s=e.attributes;return r.createElement("li",(0,n.Z)({role:"tab",tabIndex:w===t?0:-1,"aria-selected":w===t,key:t,ref:function(e){return Z.push(e)},onKeyDown:P,onFocus:I,onClick:I},s,{className:(0,o.Z)("tabs__item",c,null==s?void 0:s.className,{"tabs__item--active":w===t})}),null!=a?a:t)}))),s?(0,r.cloneElement)(y.filter((function(e){return e.props.value===w}))[0],{className:"margin-top--md"}):r.createElement("div",{className:"margin-top--md"},y.map((function(e,t){return(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==w})}))))}function u(e){var t=(0,s.Z)();return r.createElement(m,(0,n.Z)({key:String(t)},e))}},432:function(e,t,a){a.d(t,{Z:function(){return y}});var n=a(7855),r=a(9960),o=a(6886),s=a(1519),i=a(5861),l=a(4810),p=a(7294),d=a(2321),c=a(3465),m=[{label:"asset",link:"/docs/asset"},{label:"asset to big_map",link:"/docs/asset"},{label:"asset to iterable_big_map",link:"/docs/asset"},{label:"aggregate",link:"/docs/reference/types#aggregate<A>"},{label:"partition",link:"/docs/reference/types#partition<A>"},{label:"asset_view",link:"/docs/reference/types#asset_view<A>"}];function u(e){var t;return p.createElement(o.ZP,{item:!0,xs:12,style:{marginTop:"12px"}},p.createElement(o.ZP,{container:!0},p.createElement(o.ZP,{item:!0},p.createElement("h4",{style:(t={marginBottom:"0px",color:"grey",fontWeight:"normal"},t.marginBottom="12px",t)},"Type of collection ",p.createElement("code",null,"A"))),p.createElement(o.ZP,{item:!0,xs:12},p.createElement(s.Z,{className:d.Z.divider,style:{marginBottom:"12px"}})),p.createElement(o.ZP,{item:!0,xs:12},p.createElement(o.ZP,{container:!0,spacing:2},m.map((function(t,a){return p.createElement(o.ZP,{item:!0},p.createElement(r.Z,{to:t.link},p.createElement("code",{style:{textDecoration:e.data.includes(t.label)?"none":"line-through"}},t.label)))}))))))}var f=function(e){return p.createElement(o.ZP,{item:!0,xs:12},p.createElement(o.ZP,{container:!0},p.createElement(o.ZP,{item:!0,xs:12},p.createElement(s.Z,{className:d.Z.divider,style:{marginBottom:"12px"}})),p.createElement(o.ZP,{item:!0,md:e.xs,sm:6,xs:6},p.createElement(o.ZP,{container:!0},p.createElement(o.ZP,{item:!0,xs:e.xs>4?2:4},p.createElement(i.Z,null,p.createElement("code",null,e.alias)," :")),p.createElement(o.ZP,{item:!0,xs:e.xs>4?10:8},p.createElement(i.Z,null," ",void 0===e.withLink||e.withLink?p.createElement(r.Z,{to:"/docs/reference/types#"+e.type},p.createElement("code",null,e.type)):p.createElement("code",null,e.type))))),p.createElement(o.ZP,{item:!0,md:12-e.xs,sm:6,xs:6},p.createElement(i.Z,{style:{fontFamily:"IBM Plex Sans"}},e.desc))))},k=function(e){return p.createElement(o.ZP,{item:!0,xs:12},p.createElement(o.ZP,{container:!0},p.createElement(o.ZP,{item:!0,xs:12},p.createElement(s.Z,{className:d.Z.divider,style:{marginBottom:"12px"}})),p.createElement(o.ZP,{item:!0,xs:12,style:{marginBottom:"6px"}},p.createElement(i.Z,null,void 0===e.withLink||e.withLink?p.createElement(r.Z,{to:"/docs/reference/types#"+e.type},p.createElement("code",null,e.type)):p.createElement("code",null,e.type))),p.createElement(o.ZP,{item:!0,xs:10},p.createElement(i.Z,{style:{fontFamily:"IBM Plex Sans"}},e.desc))))},N=function(e){return function(e,t,a){for(var r,o=t,s=(0,n.Z)(a);!(r=s()).done;)o=e(o,r.value);return o}((function(e,t){return e>=t?e:t}),-1/0,e)};function y(e){var t,a,n=void 0!==e.data.parameters?(t=e.data.parameters,(a=N(t.map((function(e){return e.alias.length+e.type.length}))))>30?6:a>20?5:a>10?3:2):0;return p.createElement(l.Z,{injectFirst:!0},p.createElement(o.ZP,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:1,style:{marginBottom:"60px"}},p.createElement(o.ZP,{item:!0,xs:12},p.createElement(i.Z,{style:{fontFamily:"IBM Plex Sans"}},e.data.desc)),void 0!==e.data.appliesto?p.createElement(u,{data:e.data.appliesto}):p.createElement("div",null),void 0!==e.data.parameters&&e.data.parameters.length>0?p.createElement(o.ZP,{item:!0},p.createElement("h4",{style:{marginBottom:"0px",marginTop:"12px",color:"grey",fontWeight:"normal"}},e.data.parameters.length>1?"Parameters":"Parameter")):p.createElement("div",null),void 0!==e.data.parameters&&e.data.parameters.length>0?e.data.parameters.map((function(e,t){return p.createElement(f,{key:"bp"+t,alias:e.alias,type:e.type,desc:e.desc,xs:n,withLink:e.withLink})})):p.createElement("div",null),void 0!==e.data.returns?p.createElement(o.ZP,{item:!0,style:{marginTop:"12px",color:"grey"}},p.createElement("h4",{style:{marginTop:"12px",marginBottom:"0px",fontWeight:"normal"}},"Returns")):p.createElement(o.ZP,{item:!0,style:{marginTop:"12px",color:"grey"}},p.createElement("h4",{style:{marginTop:"12px",marginBottom:"0px",fontWeight:"normal"}})),void 0!==e.data.returns?p.createElement(k,{type:e.data.returns.type,withLink:e.data.returns.withLink,desc:e.data.returns.desc}):p.createElement("div",null),p.createElement(o.ZP,{item:!0,xs:12},p.createElement(c.Z,{fails:e.data.fails,michelson:e.data.michelson,michelson_ref_url:e.data.michelson_ref_url,emits:e.data.emits,related:e.data.related}))))}},6029:function(e,t,a){a.d(t,{Z:function(){return u}});var n=a(7294),r=a(6886),o=a(5861),s=a(1519),i=a(6292),l=a(9960),p=a(4048),d=a(2321),c=a(4810),m=a(563);function u(e){return n.createElement(c.Z,{injectFirst:!0},n.createElement(r.ZP,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"flex-start",spacing:1,style:{marginBottom:"60px"}},n.createElement(r.ZP,{item:!0,xs:12,style:{marginBottom:"18px"}},n.createElement(o.Z,{style:{fontFamily:"IBM Plex Sans"}},e.data.desc)),void 0!==e.data.type?n.createElement(r.ZP,{item:!0,xs:3,sm:2,md:2},n.createElement(o.Z,{style:{fontFamily:"IBM Plex Sans",color:"grey"}},"Type")):n.createElement("div",null),void 0!==e.data.type?n.createElement(r.ZP,{item:!0,xs:9,sm:10,md:10},n.createElement(l.Z,{to:"/docs/reference/types#"+(void 0!==e.data.typeUrl?e.data.typeUrl:e.data.type)},n.createElement("code",null,e.data.type))):n.createElement("div",null),void 0!==e.data.michelson?n.createElement(r.ZP,{item:!0,xs:12},n.createElement(s.Z,{className:d.Z.divider})):n.createElement("div",null),void 0!==e.data.michelson?n.createElement(r.ZP,{item:!0,xs:3,sm:2,md:2},n.createElement(o.Z,{style:{fontFamily:"IBM Plex Sans",color:"grey"}},"Michelson")):n.createElement("div",null),void 0!==e.data.michelson?n.createElement(r.ZP,{item:!0,xs:9,sm:10,md:10},n.createElement(l.Z,{to:e.data.michelson_ref_url},n.createElement(i.Z,{style:{fontFamily:"Roboto Mono",color:"var(--ifm-color-primary)"},size:"small",disableRipple:!0,endIcon:n.createElement(p.Z,{fontSize:"small"})},e.data.michelson))):n.createElement("div",null),void 0!==e.data.related&&e.data.related.length>0?n.createElement(r.ZP,{item:!0,xs:12},n.createElement(s.Z,{className:d.Z.divider})):n.createElement("div",null),void 0!==e.data.related&&e.data.related.length>0?n.createElement(r.ZP,{item:!0,xs:3,sm:2,md:2},n.createElement(o.Z,{style:{fontFamily:"IBM Plex Sans",color:"grey"}},"Related")):n.createElement("div",null),void 0!==e.data.related&&e.data.related.length>0?n.createElement(r.ZP,{item:!0,xs:9,sm:10,md:10},n.createElement(r.ZP,{container:!0,direction:"row",spacing:3},e.data.related.map((function(e,t){return n.createElement(m.n,{key:"rel"+t,value:e.keyword,link:e.link})})))):n.createElement("div",null)))}},3465:function(e,t,a){a.d(t,{Z:function(){return c}});var n=a(5861),r=a(6886),o=a(1519),s=a(7294),i=a(2321),l=a(8271),p=a(563),d=function(e){return void 0===e.fails||0===e.fails.length?s.createElement(n.Z,{style:{fontFamily:"IBM Plex Sans",color:"grey",fontStyle:"italic"}},"does not fail"):s.createElement(r.ZP,{container:!0},e.fails.map((function(t,a){return s.createElement(r.ZP,{container:!0,style:{marginBottom:e.fails.length>1?"22px":"0px"}},s.createElement(r.ZP,{key:"fk"+a,item:!0,xs:t.keyword.length>12?12:2,style:{marginBottom:t.keyword.length>12?"12px":"0px"}},s.createElement(n.Z,null,s.createElement("code",null,t.keyword))),s.createElement(r.ZP,{key:"fd"+a,item:!0,xs:t.keyword.length>12?12:10},s.createElement(n.Z,{style:{fontFamily:"IBM Plex Sans"}},t.desc)),a<e.fails.length-1?s.createElement(r.ZP,{item:!0,xs:12},s.createElement(o.Z,{className:i.Z.divider,style:{marginTop:"12px"}})):s.createElement("div",null))})))};function c(e){return s.createElement(r.ZP,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:1,style:{marginTop:"0px"}},s.createElement(r.ZP,{item:!0,xs:3,sm:2,md:2},s.createElement(n.Z,{style:{fontFamily:"IBM Plex Sans",color:"grey"}},"Fails with")),s.createElement(r.ZP,{item:!0,xs:9,sm:10,md:10},s.createElement(d,{fails:e.fails})),void 0!==e.michelson?s.createElement(r.ZP,{item:!0,xs:12},s.createElement(o.Z,{className:i.Z.divider})):s.createElement("div",null),void 0!==e.michelson?s.createElement(r.ZP,{item:!0,xs:3,sm:2,md:2},s.createElement(n.Z,{style:{fontFamily:"IBM Plex Sans",color:"grey"}},"Michelson")):s.createElement("div",null),void 0!==e.michelson?s.createElement(r.ZP,{item:!0,xs:9,sm:10,md:10},s.createElement(l.R,{michelson:e.michelson,michelson_ref_url:e.michelson_ref_url})):s.createElement("div",null),void 0!==e.emits?s.createElement(r.ZP,{item:!0,xs:12},s.createElement(o.Z,{className:i.Z.divider})):s.createElement("div",null),void 0!==e.emits?s.createElement(r.ZP,{item:!0,xs:3,sm:2,md:2},s.createElement(n.Z,{style:{fontFamily:"IBM Plex Sans",color:"grey"}},"Emits")):s.createElement("div",null),void 0!==e.emits?s.createElement(r.ZP,{item:!0,xs:9,sm:10,md:10},s.createElement(r.ZP,{container:!0,direction:"row",spacing:3},e.emits.map((function(e,t){return s.createElement(p.n,{key:"rel"+t,value:e.keyword,link:e.link,code:e.code})})))):s.createElement("div",null),void 0!==e.related?s.createElement(r.ZP,{item:!0,xs:12},s.createElement(o.Z,{className:i.Z.divider})):s.createElement("div",null),void 0!==e.related?s.createElement(r.ZP,{item:!0,xs:3,sm:2,md:2},s.createElement(n.Z,{style:{fontFamily:"IBM Plex Sans",color:"grey"}},"Related")):s.createElement("div",null),void 0!==e.related?s.createElement(r.ZP,{item:!0,xs:9,sm:10,md:10},s.createElement(r.ZP,{container:!0,direction:"row",spacing:3},e.related.map((function(e,t){return s.createElement(p.n,{key:"rel"+t,value:e.keyword,link:e.link,code:e.code})})))):s.createElement("div",null))}},8271:function(e,t,a){a.d(t,{R:function(){return l}});var n=a(7294),r=a(6292),o=a(6886),s=a(9960),i=a(4048),l=function(e){return void 0===e.michelson_ref_url?"[object Array]"!==Object.prototype.toString.call(e.michelson)?n.createElement(r.Z,{style:{textTransform:"none",fontFamily:"Roboto Mono",color:"var(--ifm-color-primary)"},disableFocusRipple:!0,size:"small",disableRipple:!0},e.michelson):n.createElement(o.ZP,{container:!0,spacing:1},e.michelson.map((function(e,t){return n.createElement(o.ZP,{item:!0,key:"mt"+t},n.createElement(r.Z,{style:{textTransform:"none",fontFamily:"Roboto Mono",color:"var(--ifm-color-primary)"},disableFocusRipple:!0,size:"small",disableRipple:!0},e))}))):n.createElement(s.Z,{to:e.michelson_ref_url},n.createElement(r.Z,{style:{textTransform:"none",fontFamily:"Roboto Mono",color:"var(--ifm-color-primary)"},size:"small",disableRipple:!0,endIcon:n.createElement(i.Z,{fontSize:"small"})},e.michelson))}},9373:function(e,t,a){a.d(t,{Z:function(){return l}});var n=a(6886),r=a(5861),o=a(1519),s=a(7294),i=a(2321);function l(e){var t=void 0!==e.width?e.width:12;return s.createElement(n.ZP,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:1,style:{marginTop:"0px",marginBottom:"24px"}},s.createElement(n.ZP,{item:!0,xs:3,sm:2,md:2},s.createElement(r.Z,{style:{fontFamily:"IBM Plex Sans",color:"grey"}},e.title)),s.createElement(n.ZP,{item:!0,xs:9,sm:10,md:10}),s.createElement(n.ZP,{item:!0,xs:12,sm:t,md:t},s.createElement(o.Z,{className:i.Z.divider})))}},563:function(e,t,a){a.d(t,{n:function(){return i}});var n=a(9960),r=a(6886),o=a(5861),s=a(7294),i=function(e){return s.createElement(r.ZP,{item:!0},s.createElement(n.Z,{to:e.link},s.createElement(o.Z,{style:{fontFamily:"IBM Plex Sans"}},null!=e.code&&!1===e.code?e.value:s.createElement("code",null,e.value))))}},7972:function(e,t,a){a.d(t,{Z:function(){return p}});var n=a(6886),r=a(5861),o=a(1519),s=a(7294),i=a(9960),l=a(2321);function p(e){return s.createElement(n.ZP,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:1,style:{marginTop:"0px"}},s.createElement(n.ZP,{item:!0,xs:3,sm:2,md:2},s.createElement(r.Z,{style:{fontFamily:"IBM Plex Sans",color:"grey"}},"Repository")),s.createElement(n.ZP,{item:!0,xs:9,sm:10,md:10},s.createElement(i.Z,{to:e.data.repo},s.createElement(r.Z,{style:{fontFamily:"IBM Plex Sans"}},e.data.repo))),s.createElement(n.ZP,{item:!0,xs:12},s.createElement(o.Z,{className:l.Z.divider})),s.createElement(n.ZP,{item:!0,xs:3,sm:2,md:2},s.createElement(r.Z,{style:{fontFamily:"IBM Plex Sans",color:"grey"}},"Author")),s.createElement(n.ZP,{item:!0,xs:9,sm:10,md:10},s.createElement(i.Z,{to:e.data.authorurl},s.createElement(r.Z,{style:{fontFamily:"IBM Plex Sans"}},e.data.author))),void 0!==e.data.norms?s.createElement(n.ZP,{item:!0,xs:12},s.createElement(o.Z,{className:l.Z.divider})):s.createElement("div",null),void 0!==e.data.norms?s.createElement(n.ZP,{item:!0,xs:12,sm:2,md:2},s.createElement(r.Z,{style:{fontFamily:"IBM Plex Sans",color:"grey"}},e.data.norms.length>1?"Norms":"Norm")):s.createElement("div",null),void 0!==e.data.norms?e.data.norms.map((function(e){return s.createElement(n.ZP,{item:!0,xs:4,sm:2,md:2},s.createElement(i.Z,{to:e.url},s.createElement(r.Z,{style:{fontFamily:"IBM Plex Sans"}},e.label)))})):s.createElement("div",null),void 0!==e.data.templates?s.createElement(n.ZP,{item:!0,xs:12},s.createElement(o.Z,{className:l.Z.divider})):s.createElement("div",null),void 0!==e.data.templates?s.createElement(n.ZP,{item:!0,xs:12,sm:2,md:2},s.createElement(r.Z,{style:{fontFamily:"IBM Plex Sans",color:"grey"}},e.data.templates.length>1?"Templates":"Template")):s.createElement("div",null),void 0!==e.data.templates?e.data.templates.map((function(e){return s.createElement(n.ZP,{item:!0,xs:4,sm:2,md:2},s.createElement(i.Z,{to:e.url},s.createElement(r.Z,{style:{fontFamily:"IBM Plex Sans"}},e.label)))})):s.createElement("div",null))}},1951:function(e,t,a){a.r(t),a.d(t,{assets:function(){return f},contentTitle:function(){return m},default:function(){return y},frontMatter:function(){return c},metadata:function(){return u},toc:function(){return k}});var n=a(7462),r=a(3366),o=(a(7294),a(3905)),s=a(2967),i=a(432),l=a(6029),p=a(7972),d=["components"],c={sidebar_position:7},m="Ownership",u={unversionedId:"templates/ownership",id:"templates/ownership",title:"Ownership",description:"This template is used in many contracts whenever there needs a special address to administrate the contract. The ownership of the contract may be transferred.",source:"@site/docs/templates/ownership.md",sourceDirName:"templates",slug:"/templates/ownership",permalink:"/docs/templates/ownership",draft:!1,editUrl:"https://github.com/completium/archetype-docs/blob/main/docs/templates/ownership.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7},sidebar:"templates",previous:{title:"Pausable",permalink:"/docs/templates/pausable"}},f={},k=[{value:"Code",id:"code",level:2},{value:"Storage",id:"storage",level:2},{value:"<code>owner</code>",id:"owner",level:3},{value:"<code>owner_candidate</code>",id:"owner_candidate",level:3},{value:"Entrypoints",id:"entrypoints",level:2},{value:"<code>declare_candidate(candidate)</code>",id:"declare_candidatecandidate",level:3},{value:"<code>claim_candidate()</code>",id:"claim_candidate",level:3}],N={toc:k};function y(e){var t=e.components,a=(0,r.Z)(e,d);return(0,o.kt)("wrapper",(0,n.Z)({},N,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"ownership"},"Ownership"),(0,o.kt)("p",null,"This template is used in many contracts whenever there needs a special address to administrate the contract. The ownership of the contract may be transferred."),(0,o.kt)(p.Z,{data:s.z.ownership.info,mdxType:"TemplateInfo"}),(0,o.kt)("h2",{id:"code"},"Code"),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"It is required to ",(0,o.kt)("em",{parentName:"p"},"copy")," this code in the created contract to benefit from the ownership pattern."))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-archetype"},'/* OWNERSHIP TRANSFER ------------------------------------------------------- */\n\nvariable owner_candidate : option<address> = none\n\nentry declare_ownership(candidate : address) {\n  called by owner\n  effect {\n    owner_candidate := some(candidate);\n  }\n}\n\nentry claim_ownership() {\n  require {\n    ownership_r1: (owner_candidate ? the = caller : false) otherwise "INVALID_CALLER"\n  }\n  effect {\n    owner := caller;\n    owner_candidate := none\n  }\n}\n')),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"/docs/reference/declarations/storage#variable"},(0,o.kt)("inlineCode",{parentName:"a"},"variable"))," ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/types#option%3CT%3E"},(0,o.kt)("inlineCode",{parentName:"a"},"option"))," ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,o.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#none%3CT%3E"},(0,o.kt)("inlineCode",{parentName:"a"},"none")),"\n",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#entry"},(0,o.kt)("inlineCode",{parentName:"a"},"entry"))," ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#require"},(0,o.kt)("inlineCode",{parentName:"a"},"require"))," ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/expressions/controls#a--b--c"},(0,o.kt)("inlineCode",{parentName:"a"},"?:"))," ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#effect"},(0,o.kt)("inlineCode",{parentName:"a"},"effect"))," ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/instructions/assignment#a--b"},(0,o.kt)("inlineCode",{parentName:"a"},":="))," ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/expressions/constants#caller"},(0,o.kt)("inlineCode",{parentName:"a"},"caller"))," ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#none"},(0,o.kt)("inlineCode",{parentName:"a"},"none"))," ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/types#address"},(0,o.kt)("inlineCode",{parentName:"a"},"address"))," ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/declarations/entrypoint#called-by"},(0,o.kt)("inlineCode",{parentName:"a"},"called by"))," ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/expressions/builtins#some(v%20:%20T)"},(0,o.kt)("inlineCode",{parentName:"a"},"some"))),(0,o.kt)("h2",{id:"storage"},"Storage"),(0,o.kt)("h3",{id:"owner"},(0,o.kt)("inlineCode",{parentName:"h3"},"owner")),(0,o.kt)(l.Z,{data:s.z.ownership.owner,mdxType:"Constant"}),(0,o.kt)("h3",{id:"owner_candidate"},(0,o.kt)("inlineCode",{parentName:"h3"},"owner_candidate")),(0,o.kt)(l.Z,{data:s.z.ownership.candidate,mdxType:"Constant"}),(0,o.kt)("h2",{id:"entrypoints"},"Entrypoints"),(0,o.kt)("h3",{id:"declare_candidatecandidate"},(0,o.kt)("inlineCode",{parentName:"h3"},"declare_candidate(candidate)")),(0,o.kt)(i.Z,{data:s.z.ownership.declare,mdxType:"Builtin"}),(0,o.kt)("h3",{id:"claim_candidate"},(0,o.kt)("inlineCode",{parentName:"h3"},"claim_candidate()")),(0,o.kt)(i.Z,{data:s.z.ownership.claim,mdxType:"Builtin"}))}y.isMDXComponent=!0},2321:function(e,t){t.Z={divider:"divider_LuCZ",gradient:"gradient_kJ7D"}}}]);