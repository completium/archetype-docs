"use strict";(self.webpackChunkarchetype_docs=self.webpackChunkarchetype_docs||[]).push([[6275],{4269:function(e,t,a){a.r(t),a.d(t,{assets:function(){return k},contentTitle:function(){return d},default:function(){return g},frontMatter:function(){return c},metadata:function(){return m},toc:function(){return u}});var n=a(7462),i=a(3366),r=(a(7294),a(3905)),p=a(4996),o=a(941),s=a(6886),l=["components"],c={},d="DApp UI",m={unversionedId:"dapps/project/index",id:"dapps/project/index",title:"DApp UI",description:"This section presents how to create and setup a DApp's User Interface (UI) project using React and Beacon's DApp/wallet interaction.",source:"@site/docs/dapps/project/index.md",sourceDirName:"dapps/project",slug:"/dapps/project/",permalink:"/docs/dapps/project/",draft:!1,editUrl:"https://github.com/completium/archetype-docs/blob/main/docs/dapps/project/index.md",tags:[],version:"current",frontMatter:{},sidebar:"dapps",previous:{title:"Introduction",permalink:"/docs/dapps/introduction"},next:{title:"App.tsx",permalink:"/docs/dapps/project/app"}},k={},u=[{value:"Technical stack",id:"technical-stack",level:2},{value:"JS Runtime",id:"js-runtime",level:3},{value:"UI Framework",id:"ui-framework",level:3},{value:"Language",id:"language",level:3},{value:"Tezos library",id:"tezos-library",level:3},{value:"Wallets",id:"wallets",level:3},{value:"Contracts bindings",id:"contracts-bindings",level:3},{value:"Store",id:"store",level:3},{value:"Architecture",id:"architecture",level:2},{value:"Project structure",id:"project-structure",level:2}],h={toc:u};function g(e){var t=e.components,a=(0,i.Z)(e,l);return(0,r.kt)("wrapper",(0,n.Z)({},h,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"dapp-ui"},"DApp UI"),(0,r.kt)("p",null,"This section presents how to create and setup a DApp's User Interface (UI) project using React and Beacon's DApp/wallet interaction."),(0,r.kt)("h2",{id:"technical-stack"},"Technical stack"),(0,r.kt)("h3",{id:"js-runtime"},"JS Runtime"),(0,r.kt)("p",null,"The use of ",(0,r.kt)("a",{parentName:"p",href:"https://nodejs.org/en/"},"Nodejs")," as the javascript execution environment is a no brainer. It is best installed with ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/nvm-sh/nvm"},(0,r.kt)("inlineCode",{parentName:"a"},"nvm")),"."),(0,r.kt)("h3",{id:"ui-framework"},"UI Framework"),(0,r.kt)("p",null,"Any UI framework is suitable to create a web DApp interface (Angular, Vue, Svelte, ...). We present here how to create a DApp UI project with ",(0,r.kt)("a",{parentName:"p",href:"https://reactjs.org/"},"React"),"."),(0,r.kt)("h3",{id:"language"},"Language"),(0,r.kt)("p",null,"It is ",(0,r.kt)("em",{parentName:"p"},"strongly")," recommended to use ",(0,r.kt)("a",{parentName:"p",href:"https://www.typescriptlang.org/"},"Typescript")," language as it will greatly shorten and ease up the development cycle. Its typed aspect makes that many errors are detected at compilation time (ie. at the time of writing code) rather than later at execution. It just doesn't make sense to developp with untyped languages when you think of it ..."),(0,r.kt)("p",null,"Project templates configured with typescript are available with most UI frameworks. The following command uses ",(0,r.kt)("inlineCode",{parentName:"p"},"create-react-app")," template with typescript:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npx create-react-app my-dapp --template typescript\n")),(0,r.kt)("p",null,"This creates the ",(0,r.kt)("inlineCode",{parentName:"p"},"my-dapp")," project. More information may be found ",(0,r.kt)("a",{parentName:"p",href:"https://create-react-app.dev/docs/adding-typescript/"},"here")),(0,r.kt)("h3",{id:"tezos-library"},"Tezos library"),(0,r.kt)("p",null,"While it is always possible to interact directly with the ",(0,r.kt)("a",{parentName:"p",href:"https://tezos.gitlab.io/active/rpc.html"},"Tezos endpoint's RPC API"),", it is more than recommended to use a dedicated library that will wrap all services in high-level development services and take care of all the low-level implementation details."),(0,r.kt)("p",null,"In the context of web DApps for Tezos, the main library is ",(0,r.kt)("a",{parentName:"p",href:"https://tezostaquito.io/"},"Taquito"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install @taquito/taquito\n")),(0,r.kt)("p",null,"Taquito uses official cryptographic packages (aka libraries). Some of these packages relies on nodejs packages designed to run on the back-end side (server side, not in a browser). These packages are ",(0,r.kt)("inlineCode",{parentName:"p"},"crypto"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"stream"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"assert"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"http"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"https"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"os"),". As a result, the deafault build process fails; it is then necessary to map these packages to their front-end counterparts in the build process:"),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Follow instructions available ",(0,r.kt)("a",{parentName:"p",href:"https://web3auth.io/docs/troubleshooting/webpack-issues"},"here")," to solve build issues."))),(0,r.kt)("p",null,"As a side note, ",(0,r.kt)("inlineCode",{parentName:"p"},"create-react-app")," uses ",(0,r.kt)("a",{parentName:"p",href:"https://webpack.js.org/"},"webpack")," (version 5) to bundle all resources as static web assets. It is then necessary to use the ",(0,r.kt)("inlineCode",{parentName:"p"},"react-app-rewired")," package as described in ",(0,r.kt)("a",{parentName:"p",href:"https://web3auth.io/docs/troubleshooting/webpack-issues"},"instructions")," above, to be able to provide a customized webpack configuration without ejecting the react app."),(0,r.kt)("h3",{id:"wallets"},"Wallets"),(0,r.kt)("p",null,"A DApp needs to interact with a wallet to ",(0,r.kt)("em",{parentName:"p"},"sign")," operations (transfers, calls to a smart contract, ...). Many wallets are available on Tezos (",(0,r.kt)("a",{parentName:"p",href:"https://templewallet.com/download/"},"Temple"),", ",(0,r.kt)("a",{parentName:"p",href:"https://wallet.kukai.app"},"Kukai"),", ",(0,r.kt)("a",{parentName:"p",href:"https://umamiwallet.com/"},"Umami"),", ...). It is common practice to interact with them all via ",(0,r.kt)("a",{parentName:"p",href:"https://docs.walletbeacon.io/"},"Beacon")," that implements the interaction standard ",(0,r.kt)("a",{parentName:"p",href:"https://tzip.tezosagora.org/proposal/tzip-10/"},"TZIP-10")," between a wallet and a dApp, as it greatly reduces the integration effort with wallets."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install @taquito/beacon-wallet @airgap/beacon-sdk\n")),(0,r.kt)("p",null,"The main drawback of Beacon is the lack of control over the UI elements (typically the wallet selection popup), which can be a no-go if you want a tight control of the DApp L&F. In that case, each wallet needs to be integrated separately."),(0,r.kt)("p",null,"A constate hook for Beacon services ",(0,r.kt)("inlineCode",{parentName:"p"},"connect")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"disconnect")," is available ",(0,r.kt)("inlineCode",{parentName:"p"},"here"),"."),(0,r.kt)("h3",{id:"contracts-bindings"},"Contracts bindings"),(0,r.kt)("p",null,"When interacting with a contract (read and write), it is ",(0,r.kt)("em",{parentName:"p"},"strongly")," recommended to use its generated typescript bindings, that is a typed high-level typescript interface. It greatly reduces the effort to call a contract, read its storage and the number of runtime errors, as the compilier and LSP guides you through the contract interface."),(0,r.kt)("p",null,"Typescript bindings may be obtained with ",(0,r.kt)("a",{parentName:"p",href:"https://completium.com/docs/cli"},"Completium CLI")," with the ",(0,r.kt)("inlineCode",{parentName:"p"},"generate binding-ts")," command. In the poll DApp example, the bindings of the ",(0,r.kt)("inlineCode",{parentName:"p"},"poll")," contract is obtained with the following command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"completium-cli generate binding-ts ./contract/poll.arl > ./bindings/poll.ts\n")),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Bindings generation is also available for Michelson (.tz) files."))),(0,r.kt)("p",null,"The generated binding interface relies on two packages:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install @completium/dapp-ts @completium/archetype-ts-types\n")),(0,r.kt)("h3",{id:"store"},"Store"),(0,r.kt)("p",null,"With React applications, it is ",(0,r.kt)("em",{parentName:"p"},"strongly")," recommended to setup a centralised store of application data (settings, UI states, ...) in read/write modes with a dedicated package like ",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/constate"},"constate")," or ",(0,r.kt)("a",{parentName:"p",href:"https://react-redux.js.org/"},"redux"),". This is preventing from awkward spaghetti code of passing components states and data through large hierarchy of components."),(0,r.kt)("p",null,"The DApp example presented here is using ",(0,r.kt)("em",{parentName:"p"},"constate")," for its lightweight aspect. Note that ",(0,r.kt)("em",{parentName:"p"},"Taquito")," and ",(0,r.kt)("em",{parentName:"p"},"Beacon")," must be ",(0,r.kt)("em",{parentName:"p"},"singletons"),", hence there are wrapped as constate hooks to make them available to UI components."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install constate\n")),(0,r.kt)("h2",{id:"architecture"},"Architecture"),(0,r.kt)("p",null,"Schema below illustrates the module and package architecture of the DApp and their interactions:"),(0,r.kt)(s.ZP,{container:!0,mdxType:"Grid"},(0,r.kt)(s.ZP,{md:1,xs:0,mdxType:"Grid"}),(0,r.kt)(s.ZP,{item:!0,md:7,xs:12,mdxType:"Grid"},(0,r.kt)(o.Z,{alt:"Buld DApp",width:"100%",sources:{light:(0,p.Z)("img/tutorial/dapp/dapp-light.svg"),dark:(0,p.Z)("img/tutorial/dapp/dapp-dark.svg")},mdxType:"ThemedImage"}))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Changes in ",(0,r.kt)("inlineCode",{parentName:"li"},"Store")," redraw ",(0,r.kt)("inlineCode",{parentName:"li"},"UI")," components (React + constate hook mecanism)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"UI")," stores DApp's states in ",(0,r.kt)("inlineCode",{parentName:"li"},"Store")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Store")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"UI")," interacts with contract via ",(0,r.kt)("inlineCode",{parentName:"li"},"Binding")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Store")," uses ",(0,r.kt)("inlineCode",{parentName:"li"},"Beacon"),"'s services to connect to a wallet"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Taquito"),"'s Tezos toolkit uses ",(0,r.kt)("inlineCode",{parentName:"li"},"Beacon")," as transaction signer"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Binding")," uses ",(0,r.kt)("inlineCode",{parentName:"li"},"@completium/dapp-ts")," package services to interact with blockchain"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"@completium/dapp-ts")," uses ",(0,r.kt)("inlineCode",{parentName:"li"},"@completium/event-listener")," to listen to emitted events")),(0,r.kt)("h2",{id:"project-structure"},"Project structure"),(0,r.kt)("p",null,"The typical file structure of the react project is presented below:"),(0,r.kt)("div",{style:{lineHeight:"20px",fontFamily:"Roboto Mono"}},(0,r.kt)("p",null,"\u251c\u2500\u2500 README.md",(0,r.kt)("br",null),"\n\u251c\u2500\u2500 config-overrides.js",(0,r.kt)("br",null),"\n\u251c\u2500\u2500 package.json",(0,r.kt)("br",null),"\n\u251c\u2500\u2500 tsconfig.json",(0,r.kt)("br",null),"\n\u251c\u2500\u2500 ",(0,r.kt)("inlineCode",{parentName:"p"},"public"),(0,r.kt)("br",null),"\n\u2502   ","\u2002","\u2002","\u251c\u2500\u2500 favicon.ico",(0,r.kt)("br",null),"\n\u2502   ","\u2002","\u2002","\u251c\u2500\u2500 index.html",(0,r.kt)("br",null),"\n\u2502   ","\u2002","\u2002","\u251c\u2500\u2500 manifest.json",(0,r.kt)("br",null),"\n\u2502   ","\u2002","\u2002","\u2514\u2500\u2500 robots.txt",(0,r.kt)("br",null),"\n\u2514\u2500\u2500 ",(0,r.kt)("inlineCode",{parentName:"p"},"src"),(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","\u251c\u2500\u2500 App.css",(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","\u251c\u2500\u2500 App.test.tsx",(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","\u251c\u2500\u2500 ",(0,r.kt)("a",{parentName:"p",href:"/docs/dapps/project/app"},"App.tsx"),(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","\u251c\u2500\u2500 index.css",(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","\u251c\u2500\u2500 index.tsx",(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","\u251c\u2500\u2500 react-app-env.d.ts",(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","\u251c\u2500\u2500 reportWebVitals.ts",(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","\u251c\u2500\u2500 setupTests.ts",(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","\u251c\u2500\u2500 ",(0,r.kt)("inlineCode",{parentName:"p"},"bindings"),(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","\u2502   ","\u2002","\u2002","\u2514\u2500\u2500 ...",(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","\u251c\u2500\u2500 ",(0,r.kt)("inlineCode",{parentName:"p"},"components"),(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","\u2502   ","\u2002","\u2002","\u2514\u2500\u2500 ...",(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","\u2514\u2500\u2500 ",(0,r.kt)("inlineCode",{parentName:"p"},"store"),(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","    ","\u2002","\u2002","\u2002","\u251c\u2500\u2500 ",(0,r.kt)("a",{parentName:"p",href:"/docs/dapps/project/beacon"},"Beacon.tsx"),(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","    ","\u2002","\u2002","\u2002","\u251c\u2500\u2500 ",(0,r.kt)("a",{parentName:"p",href:"/docs/dapps/project/taquito"},"Taquito.tsx"),(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","    ","\u2002","\u2002","\u2002","\u251c\u2500\u2500 Contract.tsx",(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","    ","\u2002","\u2002","\u2002","\u251c\u2500\u2500 ",(0,r.kt)("a",{parentName:"p",href:"/docs/dapps/project/settings"},"Settings.tsx"),(0,r.kt)("br",null),"\n","\u2002","\u2002","\u2002","\u2002","    ","\u2002","\u2002","\u2002","\u2514\u2500\u2500 ...",(0,r.kt)("br",null))),(0,r.kt)("p",null,"Note that 3 directories are created under ",(0,r.kt)("inlineCode",{parentName:"p"},"src"),":"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"bindings")," for generated contracts bindings"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"components")," for UI components"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"store")," for ",(0,r.kt)("em",{parentName:"li"},"constate")," hooks")),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Taquito")," and ",(0,r.kt)("em",{parentName:"p"},"Beacon")," hooks are presented in details."))}g.isMDXComponent=!0}}]);