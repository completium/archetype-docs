"use strict";(self.webpackChunkarchetype_docs=self.webpackChunkarchetype_docs||[]).push([[8196],{1519:(e,t,n)=>{n.d(t,{Z:()=>f});var a=n(3366),o=n(7462),r=n(7294),i=n(6010),l=n(7192),s=n(1796),c=n(2110),d=n(1539),p=n(8979);function u(e){return(0,p.Z)("MuiDivider",e)}(0,n(6087).Z)("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]);var m=n(5893);const g=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],h=(0,c.ZP)("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.absolute&&t.absolute,t[n.variant],n.light&&t.light,"vertical"===n.orientation&&t.vertical,n.flexItem&&t.flexItem,n.children&&t.withChildren,n.children&&"vertical"===n.orientation&&t.withChildrenVertical,"right"===n.textAlign&&"vertical"!==n.orientation&&t.textAlignRight,"left"===n.textAlign&&"vertical"!==n.orientation&&t.textAlignLeft]}})((({theme:e,ownerState:t})=>(0,o.Z)({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:e.palette.divider,borderBottomWidth:"thin"},t.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},t.light&&{borderColor:(0,s.Fq)(e.palette.divider,.08)},"inset"===t.variant&&{marginLeft:72},"middle"===t.variant&&"horizontal"===t.orientation&&{marginLeft:e.spacing(2),marginRight:e.spacing(2)},"middle"===t.variant&&"vertical"===t.orientation&&{marginTop:e.spacing(1),marginBottom:e.spacing(1)},"vertical"===t.orientation&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},t.flexItem&&{alignSelf:"stretch",height:"auto"})),(({theme:e,ownerState:t})=>(0,o.Z)({},t.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,"&::before, &::after":{position:"relative",width:"100%",borderTop:`thin solid ${e.palette.divider}`,top:"50%",content:'""',transform:"translateY(50%)"}})),(({theme:e,ownerState:t})=>(0,o.Z)({},t.children&&"vertical"===t.orientation&&{flexDirection:"column","&::before, &::after":{height:"100%",top:"0%",left:"50%",borderTop:0,borderLeft:`thin solid ${e.palette.divider}`,transform:"translateX(0%)"}})),(({ownerState:e})=>(0,o.Z)({},"right"===e.textAlign&&"vertical"!==e.orientation&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},"left"===e.textAlign&&"vertical"!==e.orientation&&{"&::before":{width:"10%"},"&::after":{width:"90%"}}))),v=(0,c.ZP)("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.wrapper,"vertical"===n.orientation&&t.wrapperVertical]}})((({theme:e,ownerState:t})=>(0,o.Z)({display:"inline-block",paddingLeft:`calc(${e.spacing(1)} * 1.2)`,paddingRight:`calc(${e.spacing(1)} * 1.2)`},"vertical"===t.orientation&&{paddingTop:`calc(${e.spacing(1)} * 1.2)`,paddingBottom:`calc(${e.spacing(1)} * 1.2)`}))),f=r.forwardRef((function(e,t){const n=(0,d.Z)({props:e,name:"MuiDivider"}),{absolute:r=!1,children:s,className:c,component:p=(s?"div":"hr"),flexItem:f=!1,light:b=!1,orientation:x="horizontal",role:w=("hr"!==p?"separator":void 0),textAlign:k="center",variant:Z="fullWidth"}=n,y=(0,a.Z)(n,g),B=(0,o.Z)({},n,{absolute:r,component:p,flexItem:f,light:b,orientation:x,role:w,textAlign:k,variant:Z}),S=(e=>{const{absolute:t,children:n,classes:a,flexItem:o,light:r,orientation:i,textAlign:s,variant:c}=e,d={root:["root",t&&"absolute",c,r&&"light","vertical"===i&&"vertical",o&&"flexItem",n&&"withChildren",n&&"vertical"===i&&"withChildrenVertical","right"===s&&"vertical"!==i&&"textAlignRight","left"===s&&"vertical"!==i&&"textAlignLeft"],wrapper:["wrapper","vertical"===i&&"wrapperVertical"]};return(0,l.Z)(d,u,a)})(B);return(0,m.jsx)(h,(0,o.Z)({as:p,className:(0,i.Z)(S.root,c),role:w,ref:t,ownerState:B},y,{children:s?(0,m.jsx)(v,{className:S.wrapper,ownerState:B,children:s}):null}))}))},5861:(e,t,n)=>{n.d(t,{Z:()=>x});var a=n(3366),o=n(7462),r=n(7294),i=n(6010),l=n(9707),s=n(7192),c=n(2110),d=n(1539),p=n(8216),u=n(8979);function m(e){return(0,u.Z)("MuiTypography",e)}(0,n(6087).Z)("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);var g=n(5893);const h=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],v=(0,c.ZP)("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.variant&&t[n.variant],"inherit"!==n.align&&t[`align${(0,p.Z)(n.align)}`],n.noWrap&&t.noWrap,n.gutterBottom&&t.gutterBottom,n.paragraph&&t.paragraph]}})((({theme:e,ownerState:t})=>(0,o.Z)({margin:0},t.variant&&e.typography[t.variant],"inherit"!==t.align&&{textAlign:t.align},t.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t.gutterBottom&&{marginBottom:"0.35em"},t.paragraph&&{marginBottom:16}))),f={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},b={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},x=r.forwardRef((function(e,t){const n=(0,d.Z)({props:e,name:"MuiTypography"}),r=(e=>b[e]||e)(n.color),c=(0,l.Z)((0,o.Z)({},n,{color:r})),{align:u="inherit",className:x,component:w,gutterBottom:k=!1,noWrap:Z=!1,paragraph:y=!1,variant:B="body1",variantMapping:S=f}=c,N=(0,a.Z)(c,h),W=(0,o.Z)({},c,{align:u,color:r,className:x,component:w,gutterBottom:k,noWrap:Z,paragraph:y,variant:B,variantMapping:S}),C=w||(y?"p":S[B]||f[B])||"span",_=(e=>{const{align:t,gutterBottom:n,noWrap:a,paragraph:o,variant:r,classes:i}=e,l={root:["root",r,"inherit"!==e.align&&`align${(0,p.Z)(t)}`,n&&"gutterBottom",a&&"noWrap",o&&"paragraph"]};return(0,s.Z)(l,m,i)})(W);return(0,g.jsx)(v,(0,o.Z)({as:C,ref:t,ownerState:W,className:(0,i.Z)(_.root,x)},N))}))},8216:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n(601).Z},4810:(e,t,n)=>{n.d(t,{Z:()=>l});n(7294);var a=n(4880),o=n(8357),r=n(5893);const i=(0,o.Z)({key:"css",prepend:!0});function l(e){const{injectFirst:t,children:n}=e;return t?(0,r.jsx)(a.C,{value:i,children:n}):n}},6457:(e,t,n)=>{n.d(t,{Z:()=>p});var a=n(7294),o=n(9960),r=n(6886),i=n(1519),l=n(5861),s=n(4810),c=n(2321);const d=e=>a.createElement(r.ZP,{item:!0,container:!0,xs:12},1==e.divider?a.createElement(r.ZP,{item:!0,xs:12},a.createElement(i.Z,{className:c.Z.divider,style:{marginBottom:"8px",marginTop:"4px"}})):a.createElement("div",null),a.createElement(r.ZP,{item:!0,xs:12,sm:e.xs,md:e.xs,style:{paddingLeft:"8px"}},null==e.data.link?a.createElement("code",null,e.data.label):a.createElement(o.Z,{to:e.data.link},a.createElement("code",null,e.data.label))),a.createElement(r.ZP,{item:!0,xs:12,sm:12-e.xs,md:12-e.xs,style:{paddingLeft:"8px",marginBottom:"8px"}},a.createElement(l.Z,{style:{fontFamily:"IBM Plex Sans"}},e.data.desc)));function p(e){const t=null==e.xs?3:e.xs;return a.createElement(s.Z,{injectFirst:!0},a.createElement(r.ZP,{container:!0},a.createElement(r.ZP,{item:!0,style:{paddingLeft:"8px"}},a.createElement(l.Z,{style:{fontFamily:"IBM Plex Sans",color:"grey"}},e.title)),e.data.map(((n,o)=>a.createElement(d,{divider:o>0||0==o&&e.title.length>0,data:n,xs:t})))))}},5234:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>d});var a=n(7462),o=(n(7294),n(3905)),r=n(6457);const i={sidebar_position:3,sidebar_label:"Beacon.tsx"},l="Beacon.tsx",s={unversionedId:"dapps/project/beacon",id:"dapps/project/beacon",title:"Beacon.tsx",description:"The Beacon context provides the following services:",source:"@site/docs/dapps/project/beacon.md",sourceDirName:"dapps/project",slug:"/dapps/project/beacon",permalink:"/docs/dapps/project/beacon",draft:!1,editUrl:"https://github.com/completium/archetype-docs/blob/main/docs/dapps/project/beacon.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,sidebar_label:"Beacon.tsx"},sidebar:"dapps",previous:{title:"Taquito.tsx",permalink:"/docs/dapps/project/taquito"},next:{title:"Contract.tsx",permalink:"/docs/dapps/project/contract"}},c={},d=[{value:"Code",id:"code",level:2},{value:"Usage",id:"usage",level:2}],p={toc:d};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"beacontsx"},"Beacon.tsx"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 contexts\n        \u251c\u2500\u2500 Beacon.tsx\n")),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"Beacon")," context provides the following services:"),(0,o.kt)(r.Z,{title:"Beacon.tsx",data:[{label:"useWalletAddress",desc:(0,o.kt)("div",null,"Wallet address (or ",(0,o.kt)("code",null,"undefined")," if not logged in)")},{label:"useWalletName",desc:(0,o.kt)("div",null,"Wallet name (or ",(0,o.kt)("code",null,"undefined")," if not logged in)")},{label:"useIsConnected",desc:(0,o.kt)("div",null,"Function that returns ",(0,o.kt)("code",null,"true")," if user is logged in, ",(0,o.kt)("code",null,"false")," otherwise")},{label:"useConnect",desc:(0,o.kt)("div",null,"Beacon's connect service")},{label:"useDisconnect",desc:(0,o.kt)("div",null,"Beacon's disconnect service")}],mdxType:"Api"}),(0,o.kt)("h2",{id:"code"},"Code"),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"The code below can be copied/pasted in your project as is (",(0,o.kt)("em",{parentName:"p"},"constate")," can coexist with ",(0,o.kt)("em",{parentName:"p"},"redux"),")")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import { BeaconWallet } from '@taquito/beacon-wallet';\nimport constate from 'constate';\nimport React from 'react';\n\nimport { useAppName, useEndpoint, useNetwork } from \"./Settings\";\nimport { useTezosToolkit } from \"./Taquito\";\n\nexport const [\n  BeaconProvider,\n  useWalletAddress,\n  useWalletName,\n  useConnect,\n  useDisconnect,\n  useIsConnected\n] = constate(\n  MakeBeacon,\n  (v) => v.beaconState.user_address,\n  (v) => v.beaconState.wallet,\n  (v) => v.utils.connect,\n  (v) => v.utils.disconnect,\n  (v) => v.utils.is_connected\n);\n\nfunction MakeBeacon() {\n  const network = useNetwork()\n  const endpoint = useEndpoint()\n  const name = useAppName()\n  const ttk = useTezosToolkit()\n\n  const [beaconState, setState] = React.useState(() : {\n    beacon       : undefined | BeaconWallet,\n    user_address : undefined | string,\n    wallet       : undefined | string,\n  } => ({\n    beacon       : new BeaconWallet({ name : name, preferredNetwork : network }),\n    user_address : undefined,\n    wallet       : undefined\n  }));\n\n  React.useEffect(() => {\n    // to be executed on mount\n    ttk.setWalletProvider(beaconState.beacon)\n    const on_mount = async () => {\n      const account = await beaconState.beacon?.client.getActiveAccount();\n      const address = account?.address;\n      const peers = await beaconState.beacon?.client?.getPeers();\n      const wallet_name = peers !== undefined ? peers[0].name : undefined;\n      setState(s => { return { ...s, user_address : address, wallet : wallet_name }})\n    }\n    on_mount()\n  }, []);\n\n  const connect = async () => {\n    try {\n      let beacon : BeaconWallet | undefined = undefined\n      if (beaconState.beacon) {\n        beacon = beaconState.beacon\n        ttk.setWalletProvider(beacon);\n        await beacon.requestPermissions({\n          network : {\n            type : network,\n            rpcUrl : endpoint\n          }\n        })\n        const address = await beacon.getPKH();\n        const peers = await beacon.client.getPeers()\n        const wallet_name = peers[0].name\n        setState(s => { return { ...s, user_address : address, wallet : wallet_name }})\n      } else {\n        throw new Error(\"Beacon Not Initialized\")\n      }\n    } catch(e) {\n      console.log(e)\n    }\n  }\n\n  const disconnect = async () => {\n    beaconState.beacon?.client.disconnect()\n    setState(s => { return { ...s,\n      user_address : undefined\n    }})\n  }\n\n  const is_connected = () => {\n    return beaconState.user_address !== undefined\n  }\n\n  return { beaconState, utils : { connect, disconnect, is_connected } };\n}\n")),(0,o.kt)("h2",{id:"usage"},"Usage"),(0,o.kt)("p",null,"For example, the ",(0,o.kt)("inlineCode",{parentName:"p"},"Login")," component providing the button to login to a wallet would code:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import { useConnect } from '../store/Beacon'\n\nconst LoginButton = () => {\n  const connect = useConnect()\n  return <Button onClick={connect} />\n}\n")))}u.isMDXComponent=!0},2321:(e,t,n)=>{n.d(t,{Z:()=>a});const a={divider:"divider_LuCZ",gradient:"gradient_kJ7D"}}}]);